{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { each } from '@antv/util';\nimport Action from '../base';\nimport { getElements, getMaskedElements, getSiblingMaskElements, getSilbings, isInRecords, isMask } from '../util';\n/**\n * Sibling filter\n * @ignore\n */\nvar SiblingFilter = /** @class */function (_super) {\n  __extends(SiblingFilter, _super);\n  function SiblingFilter() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.byRecord = false;\n    return _this;\n  }\n  /**\n   * 过滤隐藏图形\n   */\n  SiblingFilter.prototype.filter = function () {\n    // 仅考虑 mask 导致的过滤\n    if (isMask(this.context)) {\n      if (this.byRecord) {\n        this.filterByRecord();\n      } else {\n        this.filterByBBox();\n      }\n    }\n  };\n  // 根据框选的记录来做过滤\n  SiblingFilter.prototype.filterByRecord = function () {\n    var view = this.context.view;\n    var maskElements = getMaskedElements(this.context, 10);\n    if (!maskElements) {\n      return;\n    }\n    var xFiled = view.getXScale().field;\n    var yField = view.getYScales()[0].field;\n    var records = maskElements.map(function (el) {\n      return el.getModel().data;\n    });\n    var siblings = getSilbings(view);\n    each(siblings, function (sibling) {\n      var elements = getElements(sibling);\n      each(elements, function (el) {\n        var record = el.getModel().data;\n        // records.includes(record) 不生效，应该是数据的引用被改了\n        if (isInRecords(records, record, xFiled, yField)) {\n          el.show();\n        } else {\n          el.hide();\n        }\n      });\n    });\n  };\n  // 根据被框选的包围盒做过滤\n  SiblingFilter.prototype.filterByBBox = function () {\n    var _this = this;\n    var view = this.context.view;\n    var siblings = getSilbings(view);\n    each(siblings, function (sibling) {\n      var maskElements = getSiblingMaskElements(_this.context, sibling, 10);\n      var elements = getElements(sibling);\n      if (maskElements) {\n        // mask 过小时返回为 null，不能是空数组，否则同未框选到混淆\n        each(elements, function (el) {\n          if (maskElements.includes(el)) {\n            el.show();\n          } else {\n            el.hide();\n          }\n        });\n      }\n    });\n  };\n  /**\n   * 清理所有隐藏的图形\n   */\n  SiblingFilter.prototype.reset = function () {\n    var siblings = getSilbings(this.context.view);\n    each(siblings, function (sibling) {\n      var elements = getElements(sibling);\n      each(elements, function (el) {\n        el.show();\n      });\n    });\n  };\n  return SiblingFilter;\n}(Action);\nexport default SiblingFilter;","map":{"version":3,"names":["__extends","each","Action","getElements","getMaskedElements","getSiblingMaskElements","getSilbings","isInRecords","isMask","SiblingFilter","_super","_this","apply","arguments","byRecord","prototype","filter","context","filterByRecord","filterByBBox","view","maskElements","xFiled","getXScale","field","yField","getYScales","records","map","el","getModel","data","siblings","sibling","elements","record","show","hide","includes","reset"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@antv/g2/esm/interaction/action/element/sibling-filter.js"],"sourcesContent":["import { __extends } from \"tslib\";\nimport { each } from '@antv/util';\nimport Action from '../base';\nimport { getElements, getMaskedElements, getSiblingMaskElements, getSilbings, isInRecords, isMask } from '../util';\n/**\n * Sibling filter\n * @ignore\n */\nvar SiblingFilter = /** @class */ (function (_super) {\n    __extends(SiblingFilter, _super);\n    function SiblingFilter() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.byRecord = false;\n        return _this;\n    }\n    /**\n     * 过滤隐藏图形\n     */\n    SiblingFilter.prototype.filter = function () {\n        // 仅考虑 mask 导致的过滤\n        if (isMask(this.context)) {\n            if (this.byRecord) {\n                this.filterByRecord();\n            }\n            else {\n                this.filterByBBox();\n            }\n        }\n    };\n    // 根据框选的记录来做过滤\n    SiblingFilter.prototype.filterByRecord = function () {\n        var view = this.context.view;\n        var maskElements = getMaskedElements(this.context, 10);\n        if (!maskElements) {\n            return;\n        }\n        var xFiled = view.getXScale().field;\n        var yField = view.getYScales()[0].field;\n        var records = maskElements.map(function (el) {\n            return el.getModel().data;\n        });\n        var siblings = getSilbings(view);\n        each(siblings, function (sibling) {\n            var elements = getElements(sibling);\n            each(elements, function (el) {\n                var record = el.getModel().data;\n                // records.includes(record) 不生效，应该是数据的引用被改了\n                if (isInRecords(records, record, xFiled, yField)) {\n                    el.show();\n                }\n                else {\n                    el.hide();\n                }\n            });\n        });\n    };\n    // 根据被框选的包围盒做过滤\n    SiblingFilter.prototype.filterByBBox = function () {\n        var _this = this;\n        var view = this.context.view;\n        var siblings = getSilbings(view);\n        each(siblings, function (sibling) {\n            var maskElements = getSiblingMaskElements(_this.context, sibling, 10);\n            var elements = getElements(sibling);\n            if (maskElements) {\n                // mask 过小时返回为 null，不能是空数组，否则同未框选到混淆\n                each(elements, function (el) {\n                    if (maskElements.includes(el)) {\n                        el.show();\n                    }\n                    else {\n                        el.hide();\n                    }\n                });\n            }\n        });\n    };\n    /**\n     * 清理所有隐藏的图形\n     */\n    SiblingFilter.prototype.reset = function () {\n        var siblings = getSilbings(this.context.view);\n        each(siblings, function (sibling) {\n            var elements = getElements(sibling);\n            each(elements, function (el) {\n                el.show();\n            });\n        });\n    };\n    return SiblingFilter;\n}(Action));\nexport default SiblingFilter;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}