{"ast":null,"code":"import _asyncToGenerator from \"/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute } from '@angular/router';\nimport { ExportGiftBatchToCsvGQL } from '@ridy/admin-panel/generated/graphql';\nimport { TableService } from '@ridy/admin-panel/src/app/@services/table-service';\nimport { TagColorService } from '@ridy/admin-panel/src/app/@services/tag-color/tag-color.service';\nimport { castTo } from '@ridy/admin-panel/src/app/@services/type-caster';\nimport { environment } from '@ridy/admin-panel/src/environments/environment';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { firstValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"ng-zorro-antd/message\";\nimport * as i3 from \"@ridy/admin-panel/src/app/@services/table-service\";\nimport * as i4 from \"@ridy/admin-panel/src/app/@services/tag-color/tag-color.service\";\nimport * as i5 from \"@ridy/admin-panel/generated/graphql\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"ng-zorro-antd/table\";\nimport * as i8 from \"ng-zorro-antd/button\";\nimport * as i9 from \"ng-zorro-antd/core/transition-patch\";\nimport * as i10 from \"ng-zorro-antd/core/wave\";\nimport * as i11 from \"ng-zorro-antd/icon\";\nimport * as i12 from \"ng-zorro-antd/tag\";\nimport * as i13 from \"ng-zorro-antd/page-header\";\nimport * as i14 from \"ng-zorro-antd/descriptions\";\nimport * as i15 from \"ng-zorro-antd/tooltip\";\nimport * as i16 from \"../../../../@components/g2/nz-g2.directive\";\nimport * as i17 from \"@ngx-translate/core\";\nimport * as i18 from \"ngx-timeago\";\nconst _c0 = () => ({\n  height: 100,\n  width: 500\n});\nfunction GiftBatchViewComponent_nz_descriptions_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"nz-descriptions\")(1, \"nz-descriptions-item\", 5);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"nz-descriptions-item\", 6);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"nz-descriptions-item\", 7);\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"nz-descriptions-item\", 8)(11, \"div\", 9);\n    i0.ɵɵlistener(\"nzChartInitialized\", function GiftBatchViewComponent_nz_descriptions_7_Template_div_nzChartInitialized_11_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.onChartPayoutMethodsInit($event));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const giftBatch_r2 = ctx.ngIf;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(giftBatch_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 4, giftBatch_r2.amount, giftBatch_r2.currency));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 7, giftBatch_r2.availableFrom, \"mediumDate\") + \" - \" + i0.ɵɵpipeBind2(9, 10, giftBatch_r2.expireAt, \"mediumDate\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"nzChartOptions\", i0.ɵɵpureFunction0(13, _c0));\n  }\n}\nfunction GiftBatchViewComponent_nz_table_9_tr_11_div_4_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const data_r8 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" Used by \", data_r8.driverTransaction.driver == null ? null : data_r8.driverTransaction.driver.firstName, \" \", data_r8.driverTransaction.driver == null ? null : data_r8.driverTransaction.driver.lastName, \" \");\n  }\n}\nfunction GiftBatchViewComponent_nz_table_9_tr_11_div_4_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const data_r8 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" Used by \", data_r8.riderTransaction.rider.firstName, \" \", data_r8.riderTransaction.rider.lastName, \" \");\n  }\n}\nfunction GiftBatchViewComponent_nz_table_9_tr_11_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, GiftBatchViewComponent_nz_table_9_tr_11_div_4_div_1_Template, 2, 2, \"div\", 16)(2, GiftBatchViewComponent_nz_table_9_tr_11_div_4_div_2_Template, 2, 2, \"div\", 16);\n    i0.ɵɵelementStart(3, \"div\", 17);\n    i0.ɵɵpipe(4, \"date\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"timeago\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const data_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", data_r8.driverTransaction != null);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", data_r8.riderTransaction != null);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"nz-tooltip\", i0.ɵɵpipeBind2(4, 4, data_r8.usedAt, \"medium\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" at \", i0.ɵɵpipeBind1(6, 7, data_r8.usedAt), \" \");\n  }\n}\nfunction GiftBatchViewComponent_nz_table_9_tr_11_nz_tag_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"nz-tag\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"nzBordered\", false);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(\"Unused\");\n  }\n}\nfunction GiftBatchViewComponent_nz_table_9_tr_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 14)(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtemplate(4, GiftBatchViewComponent_nz_table_9_tr_11_div_4_Template, 7, 9, \"div\", 3)(5, GiftBatchViewComponent_nz_table_9_tr_11_nz_tag_5_Template, 2, 2, \"nz-tag\", 15);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const data_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"routerLink\", (data_r8.riderTransaction == null ? null : data_r8.riderTransaction.riderId) != null ? \"/riders/view/\" + (data_r8.riderTransaction == null ? null : data_r8.riderTransaction.riderId) : data_r8.driverTransaction != null ? \"/drivers/view/\" + data_r8.driverTransaction.driverId : null);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(data_r8.code);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", data_r8.usedAt != null);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", data_r8.usedAt == null);\n  }\n}\nfunction GiftBatchViewComponent_nz_table_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"nz-table\", 10, 11);\n    i0.ɵɵlistener(\"nzQueryParams\", function GiftBatchViewComponent_nz_table_9_Template_nz_table_nzQueryParams_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.tableService.onTableQueryParamsChange($event));\n    });\n    i0.ɵɵelementStart(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\", 12);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"tbody\");\n    i0.ɵɵtemplate(11, GiftBatchViewComponent_nz_table_9_tr_11_Template, 6, 4, \"tr\", 13);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const gifts_r5 = ctx.ngIf;\n    const _r6 = i0.ɵɵreference(1);\n    i0.ɵɵproperty(\"nzFrontPagination\", false)(\"nzData\", gifts_r5.nodes)(\"nzTotal\", gifts_r5.totalCount);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 6, \"profile.code\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(9, 8, \"profile.status\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", _r6.data);\n  }\n}\nexport class GiftBatchViewComponent {\n  constructor(route, message, tableService, tagColor, exportGql) {\n    this.route = route;\n    this.message = message;\n    this.tableService = tableService;\n    this.tagColor = tagColor;\n    this.exportGql = exportGql;\n    this.$viewGiftCaster = castTo();\n    this.$giftListCaster = castTo();\n  }\n  ngOnInit() {\n    this.route.data.subscribe(data => {\n      console.log(data);\n    });\n  }\n  onChartPayoutMethodsInit(chartInstance) {\n    this.usageChart = chartInstance;\n    this.route.data?.subscribe(result => {\n      const stats = result.giftBatch;\n      const mappedStats = [{\n        name: 'Used',\n        count: stats.data?.giftBatch.totalUsed[0].count?.id ?? 0\n      }, {\n        name: 'Unused',\n        count: stats.data?.giftBatch.totalUnused[0].count?.id ?? 0\n      }];\n      this.usageChart.data(mappedStats).interval().position('count').color('name').adjust('stack');\n      this.usageChart.coordinate('rect').transpose();\n      this.usageChart.render();\n    });\n  }\n  exportToCsv() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const url = yield firstValueFrom(_this.exportGql.mutate({\n          giftBatchId: _this.route.snapshot.params.id\n        }));\n        _this.tableService.downloadURI(environment.root + url.data?.exportGiftCardBatch, `export-${new Date().getTime()}.csv`);\n      } catch (error) {\n        _this.message.error('Export failed');\n      }\n    })();\n  }\n  static {\n    this.ɵfac = function GiftBatchViewComponent_Factory(t) {\n      return new (t || GiftBatchViewComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.NzMessageService), i0.ɵɵdirectiveInject(i3.TableService), i0.ɵɵdirectiveInject(i4.TagColorService), i0.ɵɵdirectiveInject(i5.ExportGiftBatchToCsvGQL));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: GiftBatchViewComponent,\n      selectors: [[\"app-gift-batch-view\"]],\n      decls: 11,\n      vars: 7,\n      consts: [[\"nzBackIcon\", \"\", \"nzTitle\", \"Gift Batch\", \"nzSubtitle\", \"View and export a batch of gift cards\", 3, \"nzGhost\"], [\"nz-button\", \"\", \"nzType\", \"primary\", 3, \"click\"], [\"nz-icon\", \"\", \"nzType\", \"download\"], [4, \"ngIf\"], [\"nzShowSizeChanger\", \"\", \"nzBordered\", \"\", 3, \"nzFrontPagination\", \"nzData\", \"nzTotal\", \"nzQueryParams\", 4, \"ngIf\"], [\"nzTitle\", \"Name\"], [\"nzTitle\", \"Amount\"], [\"nzTitle\", \"Availability Date Range\"], [\"nzTitle\", \"Batch usage\"], [\"nz-g2\", \"\", 3, \"nzChartOptions\", \"nzChartInitialized\"], [\"nzShowSizeChanger\", \"\", \"nzBordered\", \"\", 3, \"nzFrontPagination\", \"nzData\", \"nzTotal\", \"nzQueryParams\"], [\"table\", \"\"], [\"nzShowSort\", \"\", \"nzColumnKey\", \"usedAt\"], [3, \"routerLink\", 4, \"ngFor\", \"ngForOf\"], [3, \"routerLink\"], [\"nzColor\", \"error\", 3, \"nzBordered\", 4, \"ngIf\"], [\"class\", \"table-first-line\", 4, \"ngIf\"], [1, \"table-second-line\", 3, \"nz-tooltip\"], [1, \"table-first-line\"], [\"nzColor\", \"error\", 3, \"nzBordered\"]],\n      template: function GiftBatchViewComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"nz-page-header\", 0)(1, \"nz-page-header-extra\")(2, \"nz-button-group\")(3, \"button\", 1);\n          i0.ɵɵlistener(\"click\", function GiftBatchViewComponent_Template_button_click_3_listener() {\n            return ctx.exportToCsv();\n          });\n          i0.ɵɵelement(4, \"i\", 2);\n          i0.ɵɵtext(5, \"Export to CSV\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(6, \"nz-page-header-content\");\n          i0.ɵɵtemplate(7, GiftBatchViewComponent_nz_descriptions_7_Template, 12, 14, \"nz-descriptions\", 3);\n          i0.ɵɵpipe(8, \"async\");\n          i0.ɵɵtemplate(9, GiftBatchViewComponent_nz_table_9_Template, 12, 10, \"nz-table\", 4);\n          i0.ɵɵpipe(10, \"async\");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          let tmp_1_0;\n          let tmp_2_0;\n          i0.ɵɵproperty(\"nzGhost\", false);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"ngIf\", ctx.$viewGiftCaster((tmp_1_0 = i0.ɵɵpipeBind1(8, 3, ctx.route.data)) == null ? null : tmp_1_0.giftBatch).data.giftBatch);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.$giftListCaster((tmp_2_0 = i0.ɵɵpipeBind1(10, 5, ctx.route.data)) == null ? null : tmp_2_0.codeList).data.giftBatch.giftCodes);\n        }\n      },\n      dependencies: [i6.NgForOf, i6.NgIf, i1.RouterLink, i7.NzTableComponent, i7.NzThAddOnComponent, i7.NzTableCellDirective, i7.NzThMeasureDirective, i7.NzTheadComponent, i7.NzTbodyComponent, i7.NzTrDirective, i8.NzButtonComponent, i8.NzButtonGroupComponent, i9.ɵNzTransitionPatchDirective, i10.NzWaveDirective, i11.NzIconDirective, i12.NzTagComponent, i13.NzPageHeaderComponent, i13.NzPageHeaderContentDirective, i13.NzPageHeaderExtraDirective, i14.NzDescriptionsComponent, i14.NzDescriptionsItemComponent, i15.NzTooltipDirective, i16.NzG2Directive, i6.AsyncPipe, i6.CurrencyPipe, i6.DatePipe, i17.TranslatePipe, i18.TimeagoPipe],\n      styles: [\"nz-input-number[_ngcontent-%COMP%] {\\n    width: 100%\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdpZnQtYmF0Y2gtdmlldy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWlCO0lBQUE7QUFBWSIsImZpbGUiOiJnaWZ0LWJhdGNoLXZpZXcuY29tcG9uZW50LnRzIiwic291cmNlc0NvbnRlbnQiOlsibnotaW5wdXQtbnVtYmVyeyBAYXBwbHkgdy1mdWxsIH0iXX0= */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL2FwcHMvYWRtaW4tcGFuZWwvc3JjL2FwcC9jbXMvbWFya2V0aW5nL2dpZnQvZ2lmdC1iYXRjaC12aWV3L2dpZnQtYmF0Y2gtdmlldy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWlCO0lBQUE7QUFBWTtBQUc3QixnVEFBZ1QiLCJzb3VyY2VzQ29udGVudCI6WyJuei1pbnB1dC1udW1iZXJ7IEBhcHBseSB3LWZ1bGwgfSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n    });\n  }\n}","map":{"version":3,"names":["ActivatedRoute","ExportGiftBatchToCsvGQL","TableService","TagColorService","castTo","environment","NzMessageService","firstValueFrom","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","GiftBatchViewComponent_nz_descriptions_7_Template_div_nzChartInitialized_11_listener","$event","ɵɵrestoreView","_r4","ctx_r3","ɵɵnextContext","ɵɵresetView","onChartPayoutMethodsInit","ɵɵadvance","ɵɵtextInterpolate","giftBatch_r2","name","ɵɵpipeBind2","amount","currency","availableFrom","expireAt","ɵɵproperty","ɵɵpureFunction0","_c0","ɵɵtextInterpolate2","data_r8","driverTransaction","driver","firstName","lastName","riderTransaction","rider","ɵɵtemplate","GiftBatchViewComponent_nz_table_9_tr_11_div_4_div_1_Template","GiftBatchViewComponent_nz_table_9_tr_11_div_4_div_2_Template","usedAt","ɵɵtextInterpolate1","ɵɵpipeBind1","GiftBatchViewComponent_nz_table_9_tr_11_div_4_Template","GiftBatchViewComponent_nz_table_9_tr_11_nz_tag_5_Template","riderId","driverId","code","GiftBatchViewComponent_nz_table_9_Template_nz_table_nzQueryParams_0_listener","_r17","ctx_r16","tableService","onTableQueryParamsChange","GiftBatchViewComponent_nz_table_9_tr_11_Template","gifts_r5","nodes","totalCount","_r6","data","GiftBatchViewComponent","constructor","route","message","tagColor","exportGql","$viewGiftCaster","$giftListCaster","ngOnInit","subscribe","console","log","chartInstance","usageChart","result","stats","giftBatch","mappedStats","count","totalUsed","id","totalUnused","interval","position","color","adjust","coordinate","transpose","render","exportToCsv","_this","_asyncToGenerator","url","mutate","giftBatchId","snapshot","params","downloadURI","root","exportGiftCardBatch","Date","getTime","error","ɵɵdirectiveInject","i1","i2","i3","i4","i5","selectors","decls","vars","consts","template","GiftBatchViewComponent_Template","rf","ctx","GiftBatchViewComponent_Template_button_click_3_listener","ɵɵelement","GiftBatchViewComponent_nz_descriptions_7_Template","GiftBatchViewComponent_nz_table_9_Template","tmp_1_0","tmp_2_0","codeList","giftCodes"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/apps/admin-panel/src/app/cms/marketing/gift/gift-batch-view/gift-batch-view.component.ts","/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/apps/admin-panel/src/app/cms/marketing/gift/gift-batch-view/gift-batch-view.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { Chart } from '@antv/g2';\nimport { ApolloQueryResult } from '@apollo/client/core';\nimport {\n  ExportGiftBatchToCsvGQL,\n  GiftCodeListQuery,\n  ViewGiftBatchQuery,\n} from '@ridy/admin-panel/generated/graphql';\nimport { TableService } from '@ridy/admin-panel/src/app/@services/table-service';\nimport { TagColorService } from '@ridy/admin-panel/src/app/@services/tag-color/tag-color.service';\nimport { castTo } from '@ridy/admin-panel/src/app/@services/type-caster';\nimport { environment } from '@ridy/admin-panel/src/environments/environment';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { firstValueFrom } from 'rxjs';\n\n@Component({\n  selector: 'app-gift-batch-view',\n  templateUrl: './gift-batch-view.component.html',\n  styles: ['nz-input-number{ @apply w-full }'],\n})\nexport class GiftBatchViewComponent implements OnInit {\n  $viewGiftCaster = castTo<ApolloQueryResult<ViewGiftBatchQuery>>();\n  $giftListCaster = castTo<ApolloQueryResult<GiftCodeListQuery>>();\n  private usageChart!: Chart;\n\n  constructor(\n    public route: ActivatedRoute,\n    private message: NzMessageService,\n    public tableService: TableService,\n    public tagColor: TagColorService,\n    private exportGql: ExportGiftBatchToCsvGQL,\n  ) {}\n\n  ngOnInit(): void {\n    this.route.data.subscribe((data) => {\n      console.log(data);\n    });\n  }\n\n  onChartPayoutMethodsInit(chartInstance: Chart) {\n    this.usageChart = chartInstance;\n    this.route.data?.subscribe((result) => {\n      const stats: ApolloQueryResult<ViewGiftBatchQuery> = result.giftBatch;\n      const mappedStats = [\n        {\n          name: 'Used',\n          count: stats.data?.giftBatch.totalUsed[0].count?.id ?? 0,\n        },\n        {\n          name: 'Unused',\n          count: stats.data?.giftBatch.totalUnused[0].count?.id ?? 0,\n        },\n      ];\n      this.usageChart\n        .data(mappedStats)\n        .interval()\n        .position('count')\n        .color('name')\n        .adjust('stack');\n      this.usageChart.coordinate('rect').transpose();\n      this.usageChart.render();\n    });\n  }\n\n  async exportToCsv() {\n    try {\n      const url = await firstValueFrom(\n        this.exportGql.mutate({ giftBatchId: this.route.snapshot.params.id }),\n      );\n      this.tableService.downloadURI(\n        environment.root + url.data?.exportGiftCardBatch,\n        `export-${new Date().getTime()}.csv`,\n      );\n    } catch (error) {\n      this.message.error('Export failed');\n    }\n  }\n}\n","<nz-page-header [nzGhost]=\"false\" nzBackIcon nzTitle=\"Gift Batch\" nzSubtitle=\"View and export a batch of gift cards\">\n  <nz-page-header-extra>\n    <nz-button-group>\n      <button nz-button nzType=\"primary\" (click)=\"exportToCsv()\"><i nz-icon nzType=\"download\"></i>Export to CSV</button>\n    </nz-button-group>\n  </nz-page-header-extra>\n  <nz-page-header-content>\n    <nz-descriptions *ngIf=\"$viewGiftCaster((route.data | async)?.giftBatch).data.giftBatch as giftBatch\">\n      <nz-descriptions-item nzTitle=\"Name\">{{giftBatch.name}}</nz-descriptions-item>\n      <nz-descriptions-item nzTitle=\"Amount\">{{giftBatch.amount | currency:giftBatch.currency}}</nz-descriptions-item>\n      <nz-descriptions-item nzTitle=\"Availability Date Range\">{{(giftBatch.availableFrom | date:'mediumDate') + ' - ' +\n        (giftBatch.expireAt | date:'mediumDate')}}</nz-descriptions-item>\n      <nz-descriptions-item nzTitle=\"Batch usage\">\n        <div nz-g2 [nzChartOptions]=\"{ height: 100, width: 500 }\"\n          (nzChartInitialized)=\"onChartPayoutMethodsInit($event)\">\n        </div>\n      </nz-descriptions-item>\n    </nz-descriptions>\n    <nz-table #table nzShowSizeChanger [nzFrontPagination]=\"false\"\n      *ngIf=\"$giftListCaster((route.data | async)?.codeList).data.giftBatch.giftCodes as gifts\" [nzData]=\"gifts.nodes\"\n      [nzTotal]=\"gifts.totalCount\" (nzQueryParams)=\"tableService.onTableQueryParamsChange($event)\" nzBordered>\n      <thead>\n        <tr>\n          <th>{{ 'profile.code' | translate }}</th>\n          <th nzShowSort nzColumnKey=\"usedAt\">{{ 'profile.status' | translate }}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let data of table.data\"\n          [routerLink]=\"data.riderTransaction?.riderId != null ? ('/riders/view/' + data.riderTransaction?.riderId) : (data.driverTransaction != null ? ('/drivers/view/' + data.driverTransaction.driverId) : null)\">\n          <td>{{ data.code }}</td>\n          <td>\n            <div *ngIf=\"data.usedAt != null\">\n              <div class=\"table-first-line\" *ngIf=\"data.driverTransaction != null\">\n                Used by {{ data.driverTransaction.driver?.firstName }} {{ data.driverTransaction.driver?.lastName }}\n              </div>\n              <div class=\"table-first-line\" *ngIf=\"data.riderTransaction != null\">\n                Used by {{ data.riderTransaction.rider.firstName }} {{ data.riderTransaction.rider.lastName }}\n              </div>\n              <div class=\"table-second-line\" [nz-tooltip]=\"data.usedAt | date:'medium'\">\n                at {{ data.usedAt | timeago }}\n              </div>\n            </div>\n            <nz-tag *ngIf=\"data.usedAt == null\" nzColor=\"error\" [nzBordered]=\"false\">{{'Unused'}}</nz-tag>\n          </td>\n        </tr>\n      </tbody>\n    </nz-table>\n  </nz-page-header-content>\n</nz-page-header>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}