{"ast":null,"code":"import _asyncToGenerator from \"/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CancelOrderGQL, OrderUpdatedGQL } from '@ridy/admin-panel/generated/graphql';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { firstValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ridy/admin-panel/generated/graphql\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"ng-zorro-antd/message\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"ng-zorro-antd/button\";\nimport * as i6 from \"ng-zorro-antd/core/transition-patch\";\nimport * as i7 from \"ng-zorro-antd/core/wave\";\nimport * as i8 from \"ng-zorro-antd/result\";\nfunction DispatcherLookingComponent_nz_result_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"nz-result\", 2)(1, \"div\", 3)(2, \"button\", 4);\n    i0.ɵɵtext(3, \"View Request Details\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function DispatcherLookingComponent_nz_result_0_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.cancelRequest());\n    });\n    i0.ɵɵtext(5, \"Cancel Request\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", \"/requests/view/\" + ctx_r0.orderId);\n  }\n}\nfunction DispatcherLookingComponent_div_2_nz_result_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"nz-result\", 8)(1, \"div\", 3)(2, \"button\", 4);\n    i0.ɵɵtext(3, \"View Request Details\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const order_r4 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵpropertyInterpolate3(\"nzTitle\", \"\", order_r4.driver == null ? null : order_r4.driver.firstName, \" \", order_r4.driver == null ? null : order_r4.driver.lastName, \" (\", order_r4.driver == null ? null : order_r4.driver.mobileNumber, \") has accepted the request. Go to the trip page for more information.\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", \"/requests/view/\" + order_r4.id);\n  }\n}\nfunction DispatcherLookingComponent_div_2_nz_result_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"nz-result\", 9)(1, \"div\", 3)(2, \"button\", 4);\n    i0.ɵɵtext(3, \"View Request Details\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const order_r4 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵpropertyInterpolate1(\"nzTitle\", \"Trip status is updated to \", order_r4.status, \".\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", \"/requests/view/\" + order_r4.id);\n  }\n}\nfunction DispatcherLookingComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, DispatcherLookingComponent_div_2_nz_result_1_Template, 4, 4, \"nz-result\", 6)(2, DispatcherLookingComponent_div_2_nz_result_2_Template, 4, 2, \"nz-result\", 7);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const order_r4 = ctx.ngIf;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", order_r4.status == \"DriverAccepted\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", order_r4.status != \"DriverAccepted\");\n  }\n}\nexport class DispatcherLookingComponent {\n  constructor(orderUpdateSubscription, cancelOrderMutation, route, router, msg) {\n    this.orderUpdateSubscription = orderUpdateSubscription;\n    this.cancelOrderMutation = cancelOrderMutation;\n    this.route = route;\n    this.router = router;\n    this.msg = msg;\n  }\n  ngOnInit() {\n    this.orderId = this.route.snapshot.queryParams.requestId;\n    this.query = this.orderUpdateSubscription.subscribe({\n      id: this.orderId\n    });\n  }\n  cancelRequest() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const orderId = _this.route.snapshot.queryParams.requestId;\n      const result = yield firstValueFrom(_this.cancelOrderMutation.mutate({\n        orderId\n      }));\n      _this.msg.success('Order Canceled.');\n      _this.router.navigate(['../riders-list'], {\n        relativeTo: _this.route\n      });\n    })();\n  }\n  static {\n    this.ɵfac = function DispatcherLookingComponent_Factory(t) {\n      return new (t || DispatcherLookingComponent)(i0.ɵɵdirectiveInject(i1.OrderUpdatedGQL), i0.ɵɵdirectiveInject(i1.CancelOrderGQL), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.NzMessageService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DispatcherLookingComponent,\n      selectors: [[\"app-dispatcher-looking\"]],\n      decls: 4,\n      vars: 6,\n      consts: [[\"nzStatus\", \"info\", \"nzTitle\", \"Looking For suitable driver. Please wait...\", 4, \"ngIf\"], [4, \"ngIf\"], [\"nzStatus\", \"info\", \"nzTitle\", \"Looking For suitable driver. Please wait...\"], [\"nz-result-extra\", \"\"], [\"nz-button\", \"\", \"nzType\", \"primary\", 3, \"routerLink\"], [\"nz-button\", \"\", \"nzType\", \"primary\", \"nzDanger\", \"\", 3, \"click\"], [\"nzStatus\", \"success\", 3, \"nzTitle\", 4, \"ngIf\"], [\"nzStatus\", \"info\", 3, \"nzTitle\", 4, \"ngIf\"], [\"nzStatus\", \"success\", 3, \"nzTitle\"], [\"nzStatus\", \"info\", 3, \"nzTitle\"]],\n      template: function DispatcherLookingComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtemplate(0, DispatcherLookingComponent_nz_result_0_Template, 6, 1, \"nz-result\", 0);\n          i0.ɵɵpipe(1, \"async\");\n          i0.ɵɵtemplate(2, DispatcherLookingComponent_div_2_Template, 3, 2, \"div\", 1);\n          i0.ɵɵpipe(3, \"async\");\n        }\n        if (rf & 2) {\n          let tmp_0_0;\n          let tmp_1_0;\n          i0.ɵɵproperty(\"ngIf\", ((tmp_0_0 = i0.ɵɵpipeBind1(1, 2, ctx.query)) == null ? null : tmp_0_0.data == null ? null : tmp_0_0.data.orderUpdated) == null);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", (tmp_1_0 = i0.ɵɵpipeBind1(3, 4, ctx.query)) == null ? null : tmp_1_0.data == null ? null : tmp_1_0.data.orderUpdated);\n        }\n      },\n      dependencies: [i4.NgIf, i2.RouterLink, i5.NzButtonComponent, i6.ɵNzTransitionPatchDirective, i7.NzWaveDirective, i8.NzResultComponent, i8.NzResultExtraDirective, i4.AsyncPipe],\n      encapsulation: 2\n    });\n  }\n}","map":{"version":3,"names":["ActivatedRoute","Router","CancelOrderGQL","OrderUpdatedGQL","NzMessageService","firstValueFrom","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","DispatcherLookingComponent_nz_result_0_Template_button_click_4_listener","ɵɵrestoreView","_r3","ctx_r2","ɵɵnextContext","ɵɵresetView","cancelRequest","ɵɵadvance","ɵɵproperty","ctx_r0","orderId","ɵɵpropertyInterpolate3","order_r4","driver","firstName","lastName","mobileNumber","id","ɵɵpropertyInterpolate1","status","ɵɵtemplate","DispatcherLookingComponent_div_2_nz_result_1_Template","DispatcherLookingComponent_div_2_nz_result_2_Template","DispatcherLookingComponent","constructor","orderUpdateSubscription","cancelOrderMutation","route","router","msg","ngOnInit","snapshot","queryParams","requestId","query","subscribe","_this","_asyncToGenerator","result","mutate","success","navigate","relativeTo","ɵɵdirectiveInject","i1","i2","i3","selectors","decls","vars","consts","template","DispatcherLookingComponent_Template","rf","ctx","DispatcherLookingComponent_nz_result_0_Template","DispatcherLookingComponent_div_2_Template","tmp_0_0","ɵɵpipeBind1","data","orderUpdated","tmp_1_0"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/apps/admin-panel/src/app/cms/home/dispatcher/dispatcher-looking/dispatcher-looking.component.ts","/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/apps/admin-panel/src/app/cms/home/dispatcher/dispatcher-looking/dispatcher-looking.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport {\n  CancelOrderGQL,\n  OrderUpdatedGQL,\n  OrderUpdatedSubscription,\n} from '@ridy/admin-panel/generated/graphql';\nimport { SubscriptionResult } from 'apollo-angular';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { firstValueFrom, Observable } from 'rxjs';\n\n@Component({\n  selector: 'app-dispatcher-looking',\n  templateUrl: './dispatcher-looking.component.html',\n})\nexport class DispatcherLookingComponent implements OnInit {\n  query?: Observable<SubscriptionResult<OrderUpdatedSubscription>>;\n  orderId!: string;\n\n  constructor(\n    private orderUpdateSubscription: OrderUpdatedGQL,\n    private cancelOrderMutation: CancelOrderGQL,\n    private route: ActivatedRoute,\n    private router: Router,\n    private msg: NzMessageService,\n  ) {}\n\n  ngOnInit(): void {\n    this.orderId = this.route.snapshot.queryParams.requestId;\n    this.query = this.orderUpdateSubscription.subscribe({ id: this.orderId });\n  }\n\n  async cancelRequest() {\n    const orderId = this.route.snapshot.queryParams.requestId;\n    const result = await firstValueFrom(\n      this.cancelOrderMutation.mutate({ orderId }),\n    );\n    this.msg.success('Order Canceled.');\n    this.router.navigate(['../riders-list'], {\n      relativeTo: this.route,\n    });\n  }\n}\n","<nz-result nzStatus=\"info\" *ngIf=\"(query | async)?.data?.orderUpdated == null\"\n  nzTitle=\"Looking For suitable driver. Please wait...\">\n  <div nz-result-extra>\n    <button nz-button [routerLink]=\"'/requests/view/' + orderId\" nzType=\"primary\">View Request Details</button>\n    <button nz-button (click)=\"cancelRequest()\" nzType=\"primary\" nzDanger>Cancel Request</button>\n  </div>\n</nz-result>\n\n<div *ngIf=\"(query | async)?.data?.orderUpdated as order\">\n  <nz-result *ngIf=\"order.status == 'DriverAccepted'\" nzStatus=\"success\"\n    nzTitle=\"{{order.driver?.firstName}} {{order.driver?.lastName}} ({{order.driver?.mobileNumber}}) has accepted the request. Go to the trip page for more information.\">\n    <div nz-result-extra>\n      <button nz-button [routerLink]=\"'/requests/view/' + order.id\" nzType=\"primary\">View Request Details</button>\n    </div>\n  </nz-result>\n  <nz-result *ngIf=\"order.status != 'DriverAccepted'\" nzStatus=\"info\"\n    nzTitle=\"Trip status is updated to {{order.status}}.\">\n    <div nz-result-extra>\n      <button nz-button [routerLink]=\"'/requests/view/' + order.id\" nzType=\"primary\">View Request Details</button>\n    </div>\n  </nz-result>\n</div>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}