{"ast":null,"code":"import { __assign, __extends, __read } from \"tslib\";\nimport { deepMix, each, filter, get } from '@antv/util';\nimport { DIRECTION } from '../constant';\nimport { getFactTitleConfig } from '../util/facet';\nimport { Facet } from './facet';\n/**\n * @ignore\n * 矩阵分面\n */\nvar Rect = /** @class */function (_super) {\n  __extends(Rect, _super);\n  function Rect() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  Rect.prototype.afterEachView = function (view, facet) {\n    this.processAxis(view, facet);\n  };\n  Rect.prototype.beforeEachView = function (view, facet) {\n    // do nothing\n  };\n  Rect.prototype.getDefaultCfg = function () {\n    return deepMix({}, _super.prototype.getDefaultCfg.call(this), {\n      type: 'rect',\n      columnTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this)),\n      rowTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this))\n    });\n  };\n  Rect.prototype.render = function () {\n    _super.prototype.render.call(this);\n    if (this.cfg.showTitle) {\n      this.renderTitle();\n    }\n  };\n  /**\n   * 生成矩阵分面的分面数据\n   * @param data\n   */\n  Rect.prototype.generateFacets = function (data) {\n    var _this = this;\n    var _a = __read(this.cfg.fields, 2),\n      columnField = _a[0],\n      rowField = _a[1];\n    var rst = [];\n    var columnValuesLength = 1;\n    var rowValuesLength = 1;\n    var columnValues = [''];\n    var rowValues = [''];\n    if (columnField) {\n      columnValues = this.getFieldValues(data, columnField);\n      columnValuesLength = columnValues.length;\n    }\n    if (rowField) {\n      rowValues = this.getFieldValues(data, rowField);\n      rowValuesLength = rowValues.length;\n    }\n    // 获取每个维度对应的数据配置片段\n    columnValues.forEach(function (xVal, xIndex) {\n      rowValues.forEach(function (yVal, yIndex) {\n        var conditions = [{\n          field: columnField,\n          value: xVal,\n          values: columnValues\n        }, {\n          field: rowField,\n          value: yVal,\n          values: rowValues\n        }];\n        var facetData = filter(data, _this.getFacetDataFilter(conditions));\n        var facet = {\n          type: _this.cfg.type,\n          data: facetData,\n          region: _this.getRegion(rowValuesLength, columnValuesLength, xIndex, yIndex),\n          columnValue: xVal,\n          rowValue: yVal,\n          columnField: columnField,\n          rowField: rowField,\n          columnIndex: xIndex,\n          rowIndex: yIndex,\n          columnValuesLength: columnValuesLength,\n          rowValuesLength: rowValuesLength\n        };\n        rst.push(facet);\n      });\n    });\n    return rst;\n  };\n  Rect.prototype.renderTitle = function () {\n    var _this = this;\n    each(this.facets, function (facet, facetIndex) {\n      var columnIndex = facet.columnIndex,\n        rowIndex = facet.rowIndex,\n        columnValuesLength = facet.columnValuesLength,\n        columnValue = facet.columnValue,\n        rowValue = facet.rowValue,\n        view = facet.view;\n      // top\n      if (rowIndex === 0) {\n        var formatter = get(_this.cfg.columnTitle, 'formatter');\n        var config = deepMix({\n          position: ['50%', '0%'],\n          content: formatter ? formatter(columnValue) : columnValue\n        }, getFactTitleConfig(DIRECTION.TOP), _this.cfg.columnTitle);\n        view.annotation().text(config);\n      }\n      // right\n      if (columnIndex === columnValuesLength - 1) {\n        var formatter = get(_this.cfg.rowTitle, 'formatter');\n        var config = deepMix({\n          position: ['100%', '50%'],\n          content: formatter ? formatter(rowValue) : rowValue\n        }, getFactTitleConfig(DIRECTION.RIGHT), _this.cfg.rowTitle);\n        view.annotation().text(config);\n      }\n    });\n  };\n  /**\n   * 设置 x 坐标轴的文本、title 是否显示\n   * @param x\n   * @param axes\n   * @param option\n   * @param facet\n   */\n  Rect.prototype.getXAxisOption = function (x, axes, option, facet) {\n    // 非最后一行\n    if (facet.rowIndex !== facet.rowValuesLength - 1) {\n      return __assign(__assign({}, option), {\n        title: null,\n        label: null\n      });\n    } else if (facet.columnIndex !== Math.floor((facet.columnValuesLength - 1) / 2)) {\n      // 不是中间列\n      return __assign(__assign({}, option), {\n        title: null\n      });\n    }\n    return option;\n  };\n  /**\n   * 设置 y 坐标轴的文本、title 是否显示\n   * @param y\n   * @param axes\n   * @param option\n   * @param facet\n   */\n  Rect.prototype.getYAxisOption = function (y, axes, option, facet) {\n    if (facet.columnIndex !== 0) {\n      return __assign(__assign({}, option), {\n        title: null,\n        label: null\n      });\n    } else if (facet.rowIndex !== Math.floor((facet.rowValuesLength - 1) / 2)) {\n      return __assign(__assign({}, option), {\n        title: null\n      });\n    }\n    return option;\n  };\n  return Rect;\n}(Facet);\nexport default Rect;","map":{"version":3,"names":["__assign","__extends","__read","deepMix","each","filter","get","DIRECTION","getFactTitleConfig","Facet","Rect","_super","apply","arguments","prototype","afterEachView","view","facet","processAxis","beforeEachView","getDefaultCfg","call","type","columnTitle","getDefaultTitleCfg","rowTitle","render","cfg","showTitle","renderTitle","generateFacets","data","_this","_a","fields","columnField","rowField","rst","columnValuesLength","rowValuesLength","columnValues","rowValues","getFieldValues","length","forEach","xVal","xIndex","yVal","yIndex","conditions","field","value","values","facetData","getFacetDataFilter","region","getRegion","columnValue","rowValue","columnIndex","rowIndex","push","facets","facetIndex","formatter","config","position","content","TOP","annotation","text","RIGHT","getXAxisOption","x","axes","option","title","label","Math","floor","getYAxisOption","y"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@antv/g2/esm/facet/rect.js"],"sourcesContent":["import { __assign, __extends, __read } from \"tslib\";\nimport { deepMix, each, filter, get } from '@antv/util';\nimport { DIRECTION } from '../constant';\nimport { getFactTitleConfig } from '../util/facet';\nimport { Facet } from './facet';\n/**\n * @ignore\n * 矩阵分面\n */\nvar Rect = /** @class */ (function (_super) {\n    __extends(Rect, _super);\n    function Rect() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Rect.prototype.afterEachView = function (view, facet) {\n        this.processAxis(view, facet);\n    };\n    Rect.prototype.beforeEachView = function (view, facet) {\n        // do nothing\n    };\n    Rect.prototype.getDefaultCfg = function () {\n        return deepMix({}, _super.prototype.getDefaultCfg.call(this), {\n            type: 'rect',\n            columnTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this)),\n            rowTitle: __assign({}, _super.prototype.getDefaultTitleCfg.call(this)),\n        });\n    };\n    Rect.prototype.render = function () {\n        _super.prototype.render.call(this);\n        if (this.cfg.showTitle) {\n            this.renderTitle();\n        }\n    };\n    /**\n     * 生成矩阵分面的分面数据\n     * @param data\n     */\n    Rect.prototype.generateFacets = function (data) {\n        var _this = this;\n        var _a = __read(this.cfg.fields, 2), columnField = _a[0], rowField = _a[1];\n        var rst = [];\n        var columnValuesLength = 1;\n        var rowValuesLength = 1;\n        var columnValues = [''];\n        var rowValues = [''];\n        if (columnField) {\n            columnValues = this.getFieldValues(data, columnField);\n            columnValuesLength = columnValues.length;\n        }\n        if (rowField) {\n            rowValues = this.getFieldValues(data, rowField);\n            rowValuesLength = rowValues.length;\n        }\n        // 获取每个维度对应的数据配置片段\n        columnValues.forEach(function (xVal, xIndex) {\n            rowValues.forEach(function (yVal, yIndex) {\n                var conditions = [\n                    { field: columnField, value: xVal, values: columnValues },\n                    { field: rowField, value: yVal, values: rowValues },\n                ];\n                var facetData = filter(data, _this.getFacetDataFilter(conditions));\n                var facet = {\n                    type: _this.cfg.type,\n                    data: facetData,\n                    region: _this.getRegion(rowValuesLength, columnValuesLength, xIndex, yIndex),\n                    columnValue: xVal,\n                    rowValue: yVal,\n                    columnField: columnField,\n                    rowField: rowField,\n                    columnIndex: xIndex,\n                    rowIndex: yIndex,\n                    columnValuesLength: columnValuesLength,\n                    rowValuesLength: rowValuesLength,\n                };\n                rst.push(facet);\n            });\n        });\n        return rst;\n    };\n    Rect.prototype.renderTitle = function () {\n        var _this = this;\n        each(this.facets, function (facet, facetIndex) {\n            var columnIndex = facet.columnIndex, rowIndex = facet.rowIndex, columnValuesLength = facet.columnValuesLength, columnValue = facet.columnValue, rowValue = facet.rowValue, view = facet.view;\n            // top\n            if (rowIndex === 0) {\n                var formatter = get(_this.cfg.columnTitle, 'formatter');\n                var config = deepMix({\n                    position: ['50%', '0%'],\n                    content: formatter ? formatter(columnValue) : columnValue,\n                }, getFactTitleConfig(DIRECTION.TOP), _this.cfg.columnTitle);\n                view.annotation().text(config);\n            }\n            // right\n            if (columnIndex === columnValuesLength - 1) {\n                var formatter = get(_this.cfg.rowTitle, 'formatter');\n                var config = deepMix({\n                    position: ['100%', '50%'],\n                    content: formatter ? formatter(rowValue) : rowValue,\n                }, getFactTitleConfig(DIRECTION.RIGHT), _this.cfg.rowTitle);\n                view.annotation().text(config);\n            }\n        });\n    };\n    /**\n     * 设置 x 坐标轴的文本、title 是否显示\n     * @param x\n     * @param axes\n     * @param option\n     * @param facet\n     */\n    Rect.prototype.getXAxisOption = function (x, axes, option, facet) {\n        // 非最后一行\n        if (facet.rowIndex !== facet.rowValuesLength - 1) {\n            return __assign(__assign({}, option), { title: null, label: null });\n        }\n        else if (facet.columnIndex !== Math.floor((facet.columnValuesLength - 1) / 2)) {\n            // 不是中间列\n            return __assign(__assign({}, option), { title: null });\n        }\n        return option;\n    };\n    /**\n     * 设置 y 坐标轴的文本、title 是否显示\n     * @param y\n     * @param axes\n     * @param option\n     * @param facet\n     */\n    Rect.prototype.getYAxisOption = function (y, axes, option, facet) {\n        if (facet.columnIndex !== 0) {\n            return __assign(__assign({}, option), { title: null, label: null });\n        }\n        else if (facet.rowIndex !== Math.floor((facet.rowValuesLength - 1) / 2)) {\n            return __assign(__assign({}, option), { title: null });\n        }\n        return option;\n    };\n    return Rect;\n}(Facet));\nexport default Rect;\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AACnD,SAASC,OAAO,EAAEC,IAAI,EAAEC,MAAM,EAAEC,GAAG,QAAQ,YAAY;AACvD,SAASC,SAAS,QAAQ,aAAa;AACvC,SAASC,kBAAkB,QAAQ,eAAe;AAClD,SAASC,KAAK,QAAQ,SAAS;AAC/B;AACA;AACA;AACA;AACA,IAAIC,IAAI,GAAG,aAAe,UAAUC,MAAM,EAAE;EACxCV,SAAS,CAACS,IAAI,EAAEC,MAAM,CAAC;EACvB,SAASD,IAAIA,CAAA,EAAG;IACZ,OAAOC,MAAM,KAAK,IAAI,IAAIA,MAAM,CAACC,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC,IAAI,IAAI;EACnE;EACAH,IAAI,CAACI,SAAS,CAACC,aAAa,GAAG,UAAUC,IAAI,EAAEC,KAAK,EAAE;IAClD,IAAI,CAACC,WAAW,CAACF,IAAI,EAAEC,KAAK,CAAC;EACjC,CAAC;EACDP,IAAI,CAACI,SAAS,CAACK,cAAc,GAAG,UAAUH,IAAI,EAAEC,KAAK,EAAE;IACnD;EAAA,CACH;EACDP,IAAI,CAACI,SAAS,CAACM,aAAa,GAAG,YAAY;IACvC,OAAOjB,OAAO,CAAC,CAAC,CAAC,EAAEQ,MAAM,CAACG,SAAS,CAACM,aAAa,CAACC,IAAI,CAAC,IAAI,CAAC,EAAE;MAC1DC,IAAI,EAAE,MAAM;MACZC,WAAW,EAAEvB,QAAQ,CAAC,CAAC,CAAC,EAAEW,MAAM,CAACG,SAAS,CAACU,kBAAkB,CAACH,IAAI,CAAC,IAAI,CAAC,CAAC;MACzEI,QAAQ,EAAEzB,QAAQ,CAAC,CAAC,CAAC,EAAEW,MAAM,CAACG,SAAS,CAACU,kBAAkB,CAACH,IAAI,CAAC,IAAI,CAAC;IACzE,CAAC,CAAC;EACN,CAAC;EACDX,IAAI,CAACI,SAAS,CAACY,MAAM,GAAG,YAAY;IAChCf,MAAM,CAACG,SAAS,CAACY,MAAM,CAACL,IAAI,CAAC,IAAI,CAAC;IAClC,IAAI,IAAI,CAACM,GAAG,CAACC,SAAS,EAAE;MACpB,IAAI,CAACC,WAAW,CAAC,CAAC;IACtB;EACJ,CAAC;EACD;AACJ;AACA;AACA;EACInB,IAAI,CAACI,SAAS,CAACgB,cAAc,GAAG,UAAUC,IAAI,EAAE;IAC5C,IAAIC,KAAK,GAAG,IAAI;IAChB,IAAIC,EAAE,GAAG/B,MAAM,CAAC,IAAI,CAACyB,GAAG,CAACO,MAAM,EAAE,CAAC,CAAC;MAAEC,WAAW,GAAGF,EAAE,CAAC,CAAC,CAAC;MAAEG,QAAQ,GAAGH,EAAE,CAAC,CAAC,CAAC;IAC1E,IAAII,GAAG,GAAG,EAAE;IACZ,IAAIC,kBAAkB,GAAG,CAAC;IAC1B,IAAIC,eAAe,GAAG,CAAC;IACvB,IAAIC,YAAY,GAAG,CAAC,EAAE,CAAC;IACvB,IAAIC,SAAS,GAAG,CAAC,EAAE,CAAC;IACpB,IAAIN,WAAW,EAAE;MACbK,YAAY,GAAG,IAAI,CAACE,cAAc,CAACX,IAAI,EAAEI,WAAW,CAAC;MACrDG,kBAAkB,GAAGE,YAAY,CAACG,MAAM;IAC5C;IACA,IAAIP,QAAQ,EAAE;MACVK,SAAS,GAAG,IAAI,CAACC,cAAc,CAACX,IAAI,EAAEK,QAAQ,CAAC;MAC/CG,eAAe,GAAGE,SAAS,CAACE,MAAM;IACtC;IACA;IACAH,YAAY,CAACI,OAAO,CAAC,UAAUC,IAAI,EAAEC,MAAM,EAAE;MACzCL,SAAS,CAACG,OAAO,CAAC,UAAUG,IAAI,EAAEC,MAAM,EAAE;QACtC,IAAIC,UAAU,GAAG,CACb;UAAEC,KAAK,EAAEf,WAAW;UAAEgB,KAAK,EAAEN,IAAI;UAAEO,MAAM,EAAEZ;QAAa,CAAC,EACzD;UAAEU,KAAK,EAAEd,QAAQ;UAAEe,KAAK,EAAEJ,IAAI;UAAEK,MAAM,EAAEX;QAAU,CAAC,CACtD;QACD,IAAIY,SAAS,GAAGhD,MAAM,CAAC0B,IAAI,EAAEC,KAAK,CAACsB,kBAAkB,CAACL,UAAU,CAAC,CAAC;QAClE,IAAIhC,KAAK,GAAG;UACRK,IAAI,EAAEU,KAAK,CAACL,GAAG,CAACL,IAAI;UACpBS,IAAI,EAAEsB,SAAS;UACfE,MAAM,EAAEvB,KAAK,CAACwB,SAAS,CAACjB,eAAe,EAAED,kBAAkB,EAAEQ,MAAM,EAAEE,MAAM,CAAC;UAC5ES,WAAW,EAAEZ,IAAI;UACjBa,QAAQ,EAAEX,IAAI;UACdZ,WAAW,EAAEA,WAAW;UACxBC,QAAQ,EAAEA,QAAQ;UAClBuB,WAAW,EAAEb,MAAM;UACnBc,QAAQ,EAAEZ,MAAM;UAChBV,kBAAkB,EAAEA,kBAAkB;UACtCC,eAAe,EAAEA;QACrB,CAAC;QACDF,GAAG,CAACwB,IAAI,CAAC5C,KAAK,CAAC;MACnB,CAAC,CAAC;IACN,CAAC,CAAC;IACF,OAAOoB,GAAG;EACd,CAAC;EACD3B,IAAI,CAACI,SAAS,CAACe,WAAW,GAAG,YAAY;IACrC,IAAIG,KAAK,GAAG,IAAI;IAChB5B,IAAI,CAAC,IAAI,CAAC0D,MAAM,EAAE,UAAU7C,KAAK,EAAE8C,UAAU,EAAE;MAC3C,IAAIJ,WAAW,GAAG1C,KAAK,CAAC0C,WAAW;QAAEC,QAAQ,GAAG3C,KAAK,CAAC2C,QAAQ;QAAEtB,kBAAkB,GAAGrB,KAAK,CAACqB,kBAAkB;QAAEmB,WAAW,GAAGxC,KAAK,CAACwC,WAAW;QAAEC,QAAQ,GAAGzC,KAAK,CAACyC,QAAQ;QAAE1C,IAAI,GAAGC,KAAK,CAACD,IAAI;MAC5L;MACA,IAAI4C,QAAQ,KAAK,CAAC,EAAE;QAChB,IAAII,SAAS,GAAG1D,GAAG,CAAC0B,KAAK,CAACL,GAAG,CAACJ,WAAW,EAAE,WAAW,CAAC;QACvD,IAAI0C,MAAM,GAAG9D,OAAO,CAAC;UACjB+D,QAAQ,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC;UACvBC,OAAO,EAAEH,SAAS,GAAGA,SAAS,CAACP,WAAW,CAAC,GAAGA;QAClD,CAAC,EAAEjD,kBAAkB,CAACD,SAAS,CAAC6D,GAAG,CAAC,EAAEpC,KAAK,CAACL,GAAG,CAACJ,WAAW,CAAC;QAC5DP,IAAI,CAACqD,UAAU,CAAC,CAAC,CAACC,IAAI,CAACL,MAAM,CAAC;MAClC;MACA;MACA,IAAIN,WAAW,KAAKrB,kBAAkB,GAAG,CAAC,EAAE;QACxC,IAAI0B,SAAS,GAAG1D,GAAG,CAAC0B,KAAK,CAACL,GAAG,CAACF,QAAQ,EAAE,WAAW,CAAC;QACpD,IAAIwC,MAAM,GAAG9D,OAAO,CAAC;UACjB+D,QAAQ,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC;UACzBC,OAAO,EAAEH,SAAS,GAAGA,SAAS,CAACN,QAAQ,CAAC,GAAGA;QAC/C,CAAC,EAAElD,kBAAkB,CAACD,SAAS,CAACgE,KAAK,CAAC,EAAEvC,KAAK,CAACL,GAAG,CAACF,QAAQ,CAAC;QAC3DT,IAAI,CAACqD,UAAU,CAAC,CAAC,CAACC,IAAI,CAACL,MAAM,CAAC;MAClC;IACJ,CAAC,CAAC;EACN,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACIvD,IAAI,CAACI,SAAS,CAAC0D,cAAc,GAAG,UAAUC,CAAC,EAAEC,IAAI,EAAEC,MAAM,EAAE1D,KAAK,EAAE;IAC9D;IACA,IAAIA,KAAK,CAAC2C,QAAQ,KAAK3C,KAAK,CAACsB,eAAe,GAAG,CAAC,EAAE;MAC9C,OAAOvC,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAE2E,MAAM,CAAC,EAAE;QAAEC,KAAK,EAAE,IAAI;QAAEC,KAAK,EAAE;MAAK,CAAC,CAAC;IACvE,CAAC,MACI,IAAI5D,KAAK,CAAC0C,WAAW,KAAKmB,IAAI,CAACC,KAAK,CAAC,CAAC9D,KAAK,CAACqB,kBAAkB,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE;MAC3E;MACA,OAAOtC,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAE2E,MAAM,CAAC,EAAE;QAAEC,KAAK,EAAE;MAAK,CAAC,CAAC;IAC1D;IACA,OAAOD,MAAM;EACjB,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACIjE,IAAI,CAACI,SAAS,CAACkE,cAAc,GAAG,UAAUC,CAAC,EAAEP,IAAI,EAAEC,MAAM,EAAE1D,KAAK,EAAE;IAC9D,IAAIA,KAAK,CAAC0C,WAAW,KAAK,CAAC,EAAE;MACzB,OAAO3D,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAE2E,MAAM,CAAC,EAAE;QAAEC,KAAK,EAAE,IAAI;QAAEC,KAAK,EAAE;MAAK,CAAC,CAAC;IACvE,CAAC,MACI,IAAI5D,KAAK,CAAC2C,QAAQ,KAAKkB,IAAI,CAACC,KAAK,CAAC,CAAC9D,KAAK,CAACsB,eAAe,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE;MACrE,OAAOvC,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAE2E,MAAM,CAAC,EAAE;QAAEC,KAAK,EAAE;MAAK,CAAC,CAAC;IAC1D;IACA,OAAOD,MAAM;EACjB,CAAC;EACD,OAAOjE,IAAI;AACf,CAAC,CAACD,KAAK,CAAE;AACT,eAAeC,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}