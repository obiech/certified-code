{"ast":null,"code":"import { __assign, __extends, __rest } from \"tslib\";\nimport { clamp, deepMix, each, filter, get, mix, isNumber, isFunction } from '@antv/util';\nimport { ellipsisLabel } from '../util/label';\nimport { getMatrixByAngle, getMatrixByTranslate } from '../util/matrix';\nimport { getStatesStyle } from '../util/state';\nimport Theme from '../util/theme';\nimport LegendBase from './base';\n/**\n * 分页器 默认配置\n */\nvar DEFAULT_PAGE_NAVIGATOR = {\n  marker: {\n    style: {\n      inactiveFill: '#000',\n      inactiveOpacity: 0.45,\n      fill: '#000',\n      opacity: 1,\n      size: 12\n    }\n  },\n  text: {\n    style: {\n      fill: '#ccc',\n      fontSize: 12\n    }\n  }\n};\n// 默认 文本style\nvar textStyle = {\n  fill: Theme.textColor,\n  fontSize: 12,\n  textAlign: 'start',\n  textBaseline: 'middle',\n  fontFamily: Theme.fontFamily,\n  fontWeight: 'normal',\n  lineHeight: 12\n};\nvar RIGHT_ARROW_NAME = 'navigation-arrow-right';\nvar LEFT_ARROW_NAME = 'navigation-arrow-left';\nvar ROTATE_MAP = {\n  right: 90 * Math.PI / 180,\n  left: (360 - 90) * Math.PI / 180,\n  up: 0,\n  down: 180 * Math.PI / 180\n};\nvar Category = /** @class */function (_super) {\n  __extends(Category, _super);\n  function Category() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.currentPageIndex = 1;\n    _this.totalPagesCnt = 1;\n    _this.pageWidth = 0;\n    _this.pageHeight = 0;\n    _this.startX = 0;\n    _this.startY = 0;\n    _this.onNavigationBack = function () {\n      var itemGroup = _this.getElementByLocalId('item-group');\n      if (_this.currentPageIndex > 1) {\n        _this.currentPageIndex -= 1;\n        _this.updateNavigation();\n        var matrix = _this.getCurrentNavigationMatrix();\n        if (_this.get('animate')) {\n          itemGroup.animate({\n            matrix: matrix\n          }, 100);\n        } else {\n          itemGroup.attr({\n            matrix: matrix\n          });\n        }\n      }\n    };\n    _this.onNavigationAfter = function () {\n      var itemGroup = _this.getElementByLocalId('item-group');\n      if (_this.currentPageIndex < _this.totalPagesCnt) {\n        _this.currentPageIndex += 1;\n        _this.updateNavigation();\n        var matrix = _this.getCurrentNavigationMatrix();\n        if (_this.get('animate')) {\n          itemGroup.animate({\n            matrix: matrix\n          }, 100);\n        } else {\n          itemGroup.attr({\n            matrix: matrix\n          });\n        }\n      }\n    };\n    return _this;\n  }\n  Category.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n    return __assign(__assign({}, cfg), {\n      name: 'legend',\n      type: 'category',\n      itemSpacing: 24,\n      itemMarginBottom: 8,\n      maxItemWidth: null,\n      itemWidth: null,\n      itemHeight: null,\n      itemName: {},\n      itemValue: null,\n      maxWidth: null,\n      maxHeight: null,\n      marker: {},\n      radio: null,\n      items: [],\n      itemStates: {},\n      itemBackground: {},\n      pageNavigator: {},\n      defaultCfg: {\n        title: {\n          spacing: 5,\n          style: {\n            fill: Theme.textColor,\n            fontSize: 12,\n            textAlign: 'start',\n            textBaseline: 'top'\n          }\n        },\n        background: {\n          padding: 5,\n          style: {\n            stroke: Theme.lineColor\n          }\n        },\n        itemBackground: {\n          style: {\n            opacity: 0,\n            fill: '#fff'\n          }\n        },\n        pageNavigator: DEFAULT_PAGE_NAVIGATOR,\n        itemName: {\n          spacing: 16,\n          style: textStyle\n        },\n        marker: {\n          spacing: 8,\n          style: {\n            r: 6,\n            symbol: 'circle'\n          }\n        },\n        itemValue: {\n          alignRight: false,\n          formatter: null,\n          style: textStyle,\n          spacing: 6\n        },\n        itemStates: {\n          active: {\n            nameStyle: {\n              opacity: 0.8\n            }\n          },\n          unchecked: {\n            nameStyle: {\n              fill: Theme.uncheckedColor\n            },\n            markerStyle: {\n              fill: Theme.uncheckedColor,\n              stroke: Theme.uncheckedColor\n            }\n          },\n          inactive: {\n            nameStyle: {\n              fill: Theme.uncheckedColor\n            },\n            markerStyle: {\n              opacity: 0.2\n            }\n          }\n        }\n      }\n    });\n  };\n  // 实现 IList 接口\n  Category.prototype.isList = function () {\n    return true;\n  };\n  /**\n   * 获取图例项\n   * @return {ListItem[]} 列表项集合\n   */\n  Category.prototype.getItems = function () {\n    return this.get('items');\n  };\n  /**\n   * 设置列表项\n   * @param {ListItem[]} items 列表项集合\n   */\n  Category.prototype.setItems = function (items) {\n    this.update({\n      items: items\n    });\n  };\n  /**\n   * 更新列表项\n   * @param {ListItem} item 列表项\n   * @param {object}   cfg  列表项\n   */\n  Category.prototype.updateItem = function (item, cfg) {\n    mix(item, cfg);\n    this.clear(); // 由于单个图例项变化，会引起全局变化，所以全部更新\n    this.render();\n  };\n  /**\n   * 清空列表\n   */\n  Category.prototype.clearItems = function () {\n    var itemGroup = this.getElementByLocalId('item-group');\n    itemGroup && itemGroup.clear();\n  };\n  /**\n   * 设置列表项的状态\n   * @param {ListItem} item  列表项\n   * @param {string}   state 状态名\n   * @param {boolean}  value 状态值, true, false\n   */\n  Category.prototype.setItemState = function (item, state, value) {\n    item[state] = value;\n    var itemElement = this.getElementByLocalId(\"item-\" + item.id);\n    if (itemElement) {\n      var items = this.getItems();\n      var index = items.indexOf(item);\n      var offsetGroup = this.createOffScreenGroup(); // 离屏的 group\n      var newElement = this.drawItem(item, index, this.getItemHeight(), offsetGroup);\n      this.updateElements(newElement, itemElement); // 更新整个分组\n      this.clearUpdateStatus(itemElement); // 清理更新状态，防止出现 bug\n    }\n  };\n  /**\n   * 是否存在指定的状态\n   * @param {ListItem} item  列表项\n   * @param {boolean} state 状态名\n   */\n  Category.prototype.hasState = function (item, state) {\n    return !!item[state];\n  };\n  Category.prototype.getItemStates = function (item) {\n    var itemStates = this.get('itemStates');\n    var rst = [];\n    each(itemStates, function (v, k) {\n      if (item[k]) {\n        // item.selected\n        rst.push(k);\n      }\n    });\n    return rst;\n  };\n  /**\n   * 清楚所有列表项的状态\n   * @param {string} state 状态值\n   */\n  Category.prototype.clearItemsState = function (state) {\n    var _this = this;\n    var items = this.getItemsByState(state);\n    each(items, function (item) {\n      _this.setItemState(item, state, false);\n    });\n  };\n  /**\n   * 根据状态获取图例项\n   * @param  {string}     state [description]\n   * @return {ListItem[]}       [description]\n   */\n  Category.prototype.getItemsByState = function (state) {\n    var _this = this;\n    var items = this.getItems();\n    return filter(items, function (item) {\n      return _this.hasState(item, state);\n    });\n  };\n  // 绘制 legend 的选项\n  Category.prototype.drawLegendContent = function (group) {\n    this.processItems();\n    this.drawItems(group);\n  };\n  // 防止未设置 id\n  Category.prototype.processItems = function () {\n    var items = this.get('items');\n    each(items, function (item) {\n      if (!item.id) {\n        // 如果没有设置 id，默认使用 name\n        item.id = item.name;\n      }\n    });\n  };\n  // 绘制所有的图例选项\n  Category.prototype.drawItems = function (group) {\n    var _this = this;\n    var itemContainerGroup = this.addGroup(group, {\n      id: this.getElementId('item-container-group'),\n      name: 'legend-item-container-group'\n    });\n    var itemGroup = this.addGroup(itemContainerGroup, {\n      id: this.getElementId('item-group'),\n      name: 'legend-item-group'\n    });\n    var itemHeight = this.getItemHeight();\n    var itemWidth = this.get('itemWidth');\n    var itemSpacing = this.get('itemSpacing');\n    var itemMarginBottom = this.get('itemMarginBottom');\n    var currentPoint = this.get('currentPoint');\n    var startX = currentPoint.x;\n    var startY = currentPoint.y;\n    var layout = this.get('layout');\n    var items = this.get('items');\n    var wrapped = false;\n    var pageWidth = 0;\n    var maxWidth = this.get('maxWidth'); // 最大宽度，会导致 layout : 'horizontal' 时自动换行\n    var maxHeight = this.get('maxHeight'); // 最大高度，会导致出现分页\n    // 暂时不考虑分页\n    each(items, function (item, index) {\n      var subGroup = _this.drawItem(item, index, itemHeight, itemGroup);\n      var bbox = subGroup.getBBox();\n      var width = itemWidth || bbox.width;\n      if (width > pageWidth) {\n        pageWidth = width;\n      }\n      if (layout === 'horizontal') {\n        // 如果水平布局\n        if (maxWidth && maxWidth < currentPoint.x + width - startX) {\n          // 检测是否换行\n          wrapped = true;\n          currentPoint.x = startX;\n          currentPoint.y += itemHeight + itemMarginBottom;\n        }\n        _this.moveElementTo(subGroup, currentPoint);\n        currentPoint.x += width + itemSpacing;\n      } else {\n        // 如果垂直布局\n        if (maxHeight && maxHeight < currentPoint.y + itemHeight + itemMarginBottom - startY) {\n          // 换行\n          wrapped = true;\n          currentPoint.x += pageWidth + itemSpacing;\n          currentPoint.y = startY;\n          pageWidth = 0;\n        }\n        _this.moveElementTo(subGroup, currentPoint);\n        currentPoint.y += itemHeight + itemMarginBottom; // itemSpacing 仅影响水平间距\n      }\n    });\n\n    if (wrapped && this.get('flipPage')) {\n      this.pageHeight = 0;\n      this.pageWidth = 0;\n      this.totalPagesCnt = 1;\n      this.startX = startX;\n      this.startY = startY;\n      this.adjustNavigation(group, itemGroup);\n    }\n  };\n  // 获取图例项的高度，如果未定义，则按照 name 的高度计算\n  Category.prototype.getItemHeight = function () {\n    var itemHeight = this.get('itemHeight');\n    if (!itemHeight) {\n      var style_1 = (this.get('itemName') || {}).style;\n      if (isFunction(style_1)) {\n        var items_1 = this.getItems();\n        items_1.forEach(function (item, index) {\n          var fontSize = __assign(__assign({}, textStyle), style_1(item, index, items_1)).fontSize;\n          if (itemHeight < fontSize) {\n            itemHeight = fontSize;\n          }\n        });\n      } else if (style_1) {\n        itemHeight = style_1.fontSize;\n      }\n    }\n    return itemHeight;\n  };\n  // 绘制 marker\n  Category.prototype.drawMarker = function (container, markerCfg, item, itemHeight) {\n    var markerAttrs = __assign(__assign(__assign({\n      x: 0,\n      y: itemHeight / 2\n    }, markerCfg.style), {\n      symbol: get(item.marker, 'symbol', 'circle')\n    }), get(item.marker, 'style', {}));\n    var shape = this.addShape(container, {\n      type: 'marker',\n      id: this.getElementId(\"item-\" + item.id + \"-marker\"),\n      name: 'legend-item-marker',\n      attrs: markerAttrs\n    });\n    var bbox = shape.getBBox();\n    shape.attr('x', bbox.width / 2); // marker 需要左对齐，所以不能占用左侧的空间\n    var _a = shape.attr(),\n      stroke = _a.stroke,\n      fill = _a.fill;\n    if (stroke) {\n      shape.set('isStroke', true);\n    }\n    if (fill) {\n      shape.set('isFill', true);\n    }\n    return shape;\n  };\n  // 绘制文本\n  Category.prototype.drawItemText = function (container, textName, cfg, item, itemHeight, xPosition, index) {\n    var formatter = cfg.formatter;\n    var style = cfg.style;\n    var attrs = __assign(__assign({\n      x: xPosition,\n      y: itemHeight / 2,\n      text: formatter ? formatter(item[textName], item, index) : item[textName]\n    }, textStyle), isFunction(style) ? style(item, index, this.getItems()) : style);\n    return this.addShape(container, {\n      type: 'text',\n      id: this.getElementId(\"item-\" + item.id + \"-\" + textName),\n      name: \"legend-item-\" + textName,\n      attrs: attrs\n    });\n  };\n  Category.prototype.drawRadio = function (container, radioCfg, item, itemHeight, x) {\n    var _a, _b;\n    var style = radioCfg.style || {};\n    // 以用户设置的 r 为主\n    var r = (_a = style.r) !== null && _a !== void 0 ? _a : itemHeight / 2;\n    var lineWidth = r * 3.6 / 8;\n    var _c = [x + r, itemHeight / 2 - r],\n      x0 = _c[0],\n      y0 = _c[1];\n    var _d = [x0 + r, y0 + r],\n      x1 = _d[0],\n      y1 = _d[1];\n    var _e = [x0, y1 + r],\n      x2 = _e[0],\n      y2 = _e[1];\n    var _f = [x, y0 + r],\n      x3 = _f[0],\n      y3 = _f[1];\n    var showRadio = item.showRadio;\n    var attrs = __assign(__assign({\n      path: [['M', x0, y0], ['A', r, r, 0, 0, 1, x1, y1], ['L', x1 - lineWidth, y1], ['L', x1, y1], ['A', r, r, 0, 0, 1, x2, y2], ['L', x2, y2 - lineWidth], ['L', x2, y2], ['A', r, r, 0, 0, 1, x3, y3], ['L', x3 + lineWidth, y3], ['L', x3, y3], ['A', r, r, 0, 0, 1, x0, y0], ['L', x0, y0 + lineWidth]],\n      stroke: '#000000',\n      fill: '#ffffff'\n    }, style), {\n      opacity: showRadio ? (_b = style === null || style === void 0 ? void 0 : style.opacity) !== null && _b !== void 0 ? _b : 0.45 : 0\n    });\n    var radioShape = this.addShape(container, {\n      type: 'path',\n      id: this.getElementId(\"item-\" + item.id + \"-radio\"),\n      name: 'legend-item-radio',\n      attrs: attrs\n    });\n    radioShape.set('tip', radioCfg.tip);\n    return radioShape;\n  };\n  // 绘制图例项\n  Category.prototype.drawItem = function (item, index, itemHeight, itemGroup) {\n    var groupId = \"item-\" + item.id;\n    // 设置单独的 Group 用于 setClip\n    var subContainer = this.addGroup(itemGroup, {\n      name: 'legend-item-container',\n      id: this.getElementId(\"item-container-\" + groupId),\n      delegateObject: {\n        item: item,\n        index: index\n      }\n    });\n    var subGroup = this.addGroup(subContainer, {\n      name: 'legend-item',\n      id: this.getElementId(groupId),\n      delegateObject: {\n        item: item,\n        index: index\n      }\n    });\n    var marker = this.get('marker');\n    var itemName = this.get('itemName');\n    var itemValue = this.get('itemValue');\n    var itemBackground = this.get('itemBackground');\n    var radio = this.get('radio');\n    var itemWidth = this.getLimitItemWidth();\n    var curX = 0; // 记录当前 x 的位置\n    if (marker) {\n      var markerShape = this.drawMarker(subGroup, marker, item, itemHeight);\n      var spacing = marker.spacing;\n      var itemMarkerSpacing = get(item, ['marker', 'spacing']);\n      if (isNumber(itemMarkerSpacing)) {\n        // 如果 item 有配置 marker.spacing，采用 item 的配置\n        spacing = itemMarkerSpacing;\n      }\n      curX = markerShape.getBBox().maxX + spacing;\n    }\n    if (itemName) {\n      var nameShape = this.drawItemText(subGroup, 'name', itemName, item, itemHeight, curX, index);\n      if (itemWidth) {\n        // 设置了 item 的最大宽度限制，并且超出了，进行省略处理\n        ellipsisLabel(true, nameShape, clamp(itemWidth - curX, 0, itemWidth));\n      }\n      curX = nameShape.getBBox().maxX + itemName.spacing;\n    }\n    if (itemValue) {\n      var valueShape = this.drawItemText(subGroup, 'value', itemValue, item, itemHeight, curX, index);\n      if (itemWidth) {\n        if (itemValue.alignRight) {\n          valueShape.attr({\n            textAlign: 'right',\n            x: itemWidth\n          });\n          ellipsisLabel(true, valueShape, clamp(itemWidth - curX, 0, itemWidth), 'head');\n        } else {\n          ellipsisLabel(true, valueShape, clamp(itemWidth - curX, 0, itemWidth));\n        }\n      }\n      curX = valueShape.getBBox().maxX + itemValue.spacing;\n    }\n    if (radio) {\n      this.drawRadio(subGroup, radio, item, itemHeight, curX);\n    }\n    // 添加透明的背景，便于拾取和包围盒计算\n    if (itemBackground) {\n      var bbox = subGroup.getBBox();\n      var backShape = this.addShape(subGroup, {\n        type: 'rect',\n        name: 'legend-item-background',\n        id: this.getElementId(groupId + \"-background\"),\n        attrs: __assign({\n          x: 0,\n          y: 0,\n          width: bbox.width,\n          height: itemHeight\n        }, itemBackground.style)\n      });\n      backShape.toBack();\n    }\n    this.applyItemStates(item, subGroup);\n    return subGroup;\n  };\n  // 加上分页器并重新排序 items\n  Category.prototype.adjustNavigation = function (container, itemGroup) {\n    var _this = this;\n    var startX = this.startX;\n    var startY = this.startY;\n    var layout = this.get('layout');\n    var subGroups = itemGroup.findAll(function (item) {\n      return item.get('name') === 'legend-item';\n    });\n    var maxWidth = this.get('maxWidth');\n    var maxHeight = this.get('maxHeight');\n    var itemWidth = this.get('itemWidth');\n    var itemSpacing = this.get('itemSpacing');\n    var itemHeight = this.getItemHeight();\n    var pageNavigator = deepMix({}, DEFAULT_PAGE_NAVIGATOR, this.get('pageNavigator'));\n    var navigation = this.drawNavigation(container, layout, '00/00', pageNavigator);\n    var navigationBBox = navigation.getBBox();\n    var currentPoint = {\n      x: startX,\n      y: startY\n    };\n    var pages = 1;\n    var widthLimit = 0;\n    var pageWidth = 0;\n    var maxItemWidth = 0;\n    var itemMarginBottom = this.get('itemMarginBottom');\n    /**  判断当前 item 是否溢出当前页。是的话，需要换行 */\n    function shouldWrap(item, currentPoint) {\n      var bbox = item.getBBox();\n      var width = itemWidth || bbox.width;\n      var newItemXPos = currentPoint.x + width + itemSpacing + navigationBBox.width;\n      return newItemXPos > maxWidth;\n    }\n    if (layout === 'horizontal') {\n      var maxRow = this.get('maxRow') || 1;\n      var maxRowHeight_1 = itemHeight + (maxRow === 1 ? 0 : itemMarginBottom);\n      // 分页器一直靠右上角\n      var navigationX_1 = maxWidth - itemSpacing - navigationBBox.width - navigationBBox.minX; // 理论上不需要减 navigationBBox.minX\n      this.pageHeight = maxRowHeight_1 * maxRow;\n      this.pageWidth = navigationX_1;\n      each(subGroups, function (item) {\n        var bbox = item.getBBox();\n        var width = itemWidth || bbox.width;\n        if (widthLimit && widthLimit < currentPoint.x + width + itemSpacing || shouldWrap(item, currentPoint)) {\n          if (pages === 1) {\n            widthLimit = currentPoint.x + itemSpacing;\n            _this.moveElementTo(navigation, {\n              x: navigationX_1,\n              y: currentPoint.y + itemHeight / 2 - navigationBBox.height / 2 - navigationBBox.minY\n            });\n          }\n          pages += 1;\n          currentPoint.x = startX;\n          currentPoint.y += maxRowHeight_1;\n        }\n        _this.moveElementTo(item, currentPoint);\n        item.getParent().setClip({\n          type: 'rect',\n          attrs: {\n            x: currentPoint.x,\n            y: currentPoint.y,\n            width: width + itemSpacing,\n            height: itemHeight\n          }\n        });\n        currentPoint.x += width + itemSpacing;\n      });\n    } else {\n      each(subGroups, function (item) {\n        var bbox = item.getBBox();\n        if (bbox.width > pageWidth) {\n          pageWidth = bbox.width;\n        }\n      });\n      maxItemWidth = pageWidth;\n      pageWidth += itemSpacing;\n      if (maxWidth) {\n        // maxWidth 限制加上\n        pageWidth = Math.min(maxWidth, pageWidth);\n        maxItemWidth = Math.min(maxWidth, maxItemWidth);\n      }\n      this.pageWidth = pageWidth;\n      this.pageHeight = maxHeight - Math.max(navigationBBox.height, itemHeight + itemMarginBottom);\n      var cntPerPage_1 = Math.floor(this.pageHeight / (itemHeight + itemMarginBottom));\n      each(subGroups, function (item, index) {\n        if (index !== 0 && index % cntPerPage_1 === 0) {\n          pages += 1;\n          currentPoint.x += pageWidth;\n          currentPoint.y = startY;\n        }\n        _this.moveElementTo(item, currentPoint);\n        item.getParent().setClip({\n          type: 'rect',\n          attrs: {\n            x: currentPoint.x,\n            y: currentPoint.y,\n            width: pageWidth,\n            height: itemHeight\n          }\n        });\n        currentPoint.y += itemHeight + itemMarginBottom;\n      });\n      this.totalPagesCnt = pages;\n      this.moveElementTo(navigation, {\n        x: startX + maxItemWidth / 2 - navigationBBox.width / 2 - navigationBBox.minX,\n        y: maxHeight - navigationBBox.height - navigationBBox.minY\n      });\n    }\n    if (this.pageHeight && this.pageWidth) {\n      // 为了使固定的 clip 生效，clip 设置在 itemContainerGroup 上，itemGroup 需要在翻页时会设置 matrix\n      itemGroup.getParent().setClip({\n        type: 'rect',\n        attrs: {\n          x: this.startX,\n          y: this.startY,\n          width: this.pageWidth,\n          height: this.pageHeight\n        }\n      });\n    }\n    // 重新计算 totalPagesCnt\n    if (layout === 'horizontal' && this.get('maxRow')) {\n      this.totalPagesCnt = Math.ceil(pages / this.get('maxRow'));\n    } else {\n      this.totalPagesCnt = pages;\n    }\n    if (this.currentPageIndex > this.totalPagesCnt) {\n      this.currentPageIndex = 1;\n    }\n    this.updateNavigation(navigation);\n    // update initial matrix\n    itemGroup.attr('matrix', this.getCurrentNavigationMatrix());\n  };\n  /**\n   * 绘制分页器\n   */\n  Category.prototype.drawNavigation = function (group, layout, text, styleCfg) {\n    var currentPoint = {\n      x: 0,\n      y: 0\n    };\n    var subGroup = this.addGroup(group, {\n      id: this.getElementId('navigation-group'),\n      name: 'legend-navigation'\n    });\n    var _a = get(styleCfg.marker, 'style', {}),\n      _b = _a.size,\n      size = _b === void 0 ? 12 : _b,\n      arrowStyle = __rest(_a, [\"size\"]);\n    var leftArrow = this.drawArrow(subGroup, currentPoint, LEFT_ARROW_NAME, layout === 'horizontal' ? 'up' : 'left', size, arrowStyle);\n    leftArrow.on('click', this.onNavigationBack);\n    var leftArrowBBox = leftArrow.getBBox();\n    currentPoint.x += leftArrowBBox.width + 2;\n    var textShape = this.addShape(subGroup, {\n      type: 'text',\n      id: this.getElementId('navigation-text'),\n      name: 'navigation-text',\n      attrs: __assign({\n        x: currentPoint.x,\n        y: currentPoint.y + size / 2,\n        text: text,\n        textBaseline: 'middle'\n      }, get(styleCfg.text, 'style'))\n    });\n    var textBBox = textShape.getBBox();\n    currentPoint.x += textBBox.width + 2;\n    var rightArrow = this.drawArrow(subGroup, currentPoint, RIGHT_ARROW_NAME, layout === 'horizontal' ? 'down' : 'right', size, arrowStyle);\n    rightArrow.on('click', this.onNavigationAfter);\n    return subGroup;\n  };\n  Category.prototype.updateNavigation = function (navigation) {\n    var pageNavigator = deepMix({}, DEFAULT_PAGE_NAVIGATOR, this.get('pageNavigator'));\n    var _a = pageNavigator.marker.style,\n      fill = _a.fill,\n      opacity = _a.opacity,\n      inactiveFill = _a.inactiveFill,\n      inactiveOpacity = _a.inactiveOpacity;\n    var text = this.currentPageIndex + \"/\" + this.totalPagesCnt;\n    var textShape = navigation ? navigation.getChildren()[1] : this.getElementByLocalId('navigation-text');\n    var leftArrow = navigation ? navigation.findById(this.getElementId(LEFT_ARROW_NAME)) : this.getElementByLocalId(LEFT_ARROW_NAME);\n    var rightArrow = navigation ? navigation.findById(this.getElementId(RIGHT_ARROW_NAME)) : this.getElementByLocalId(RIGHT_ARROW_NAME);\n    textShape.attr('text', text);\n    // 更新 left-arrow marker\n    leftArrow.attr('opacity', this.currentPageIndex === 1 ? inactiveOpacity : opacity);\n    leftArrow.attr('fill', this.currentPageIndex === 1 ? inactiveFill : fill);\n    leftArrow.attr('cursor', this.currentPageIndex === 1 ? 'not-allowed' : 'pointer');\n    // 更新 right-arrow marker\n    rightArrow.attr('opacity', this.currentPageIndex === this.totalPagesCnt ? inactiveOpacity : opacity);\n    rightArrow.attr('fill', this.currentPageIndex === this.totalPagesCnt ? inactiveFill : fill);\n    rightArrow.attr('cursor', this.currentPageIndex === this.totalPagesCnt ? 'not-allowed' : 'pointer');\n    // 更新位置\n    var cursorX = leftArrow.getBBox().maxX + 2;\n    textShape.attr('x', cursorX);\n    cursorX += textShape.getBBox().width + 2;\n    this.updateArrowPath(rightArrow, {\n      x: cursorX,\n      y: 0\n    });\n  };\n  Category.prototype.drawArrow = function (group, currentPoint, name, direction, size, style) {\n    var x = currentPoint.x,\n      y = currentPoint.y;\n    var shape = this.addShape(group, {\n      type: 'path',\n      id: this.getElementId(name),\n      name: name,\n      attrs: __assign({\n        size: size,\n        direction: direction,\n        path: [['M', x + size / 2, y], ['L', x, y + size], ['L', x + size, y + size], ['Z']],\n        cursor: 'pointer'\n      }, style)\n    });\n    shape.attr('matrix', getMatrixByAngle({\n      x: x + size / 2,\n      y: y + size / 2\n    }, ROTATE_MAP[direction]));\n    return shape;\n  };\n  /**\n   * 更新分页器 arrow 组件\n   */\n  Category.prototype.updateArrowPath = function (arrow, point) {\n    var x = point.x,\n      y = point.y;\n    var _a = arrow.attr(),\n      size = _a.size,\n      direction = _a.direction;\n    var matrix = getMatrixByAngle({\n      x: x + size / 2,\n      y: y + size / 2\n    }, ROTATE_MAP[direction]);\n    arrow.attr('path', [['M', x + size / 2, y], ['L', x, y + size], ['L', x + size, y + size], ['Z']]);\n    arrow.attr('matrix', matrix);\n  };\n  Category.prototype.getCurrentNavigationMatrix = function () {\n    var _a = this,\n      currentPageIndex = _a.currentPageIndex,\n      pageWidth = _a.pageWidth,\n      pageHeight = _a.pageHeight;\n    var layout = this.get('layout');\n    var translate = layout === 'horizontal' ? {\n      x: 0,\n      y: pageHeight * (1 - currentPageIndex)\n    } : {\n      x: pageWidth * (1 - currentPageIndex),\n      y: 0\n    };\n    return getMatrixByTranslate(translate);\n  };\n  // 附加状态对应的样式\n  Category.prototype.applyItemStates = function (item, subGroup) {\n    var states = this.getItemStates(item);\n    var hasStates = states.length > 0;\n    if (hasStates) {\n      var children = subGroup.getChildren();\n      var itemStates_1 = this.get('itemStates');\n      each(children, function (element) {\n        var name = element.get('name');\n        var elName = name.split('-')[2]; // marker, name, value\n        var statesStyle = getStatesStyle(item, elName, itemStates_1);\n        if (statesStyle) {\n          element.attr(statesStyle);\n          if (elName === 'marker' && !(element.get('isStroke') && element.get('isFill'))) {\n            // 如果 marker 是单填充或者单描边的话，就不要额外添加 stroke 或这 fill 属性，否则会影响 unchecked 后的显示\n            if (element.get('isStroke')) {\n              element.attr('fill', null);\n            }\n            if (element.get('isFill')) {\n              element.attr('stroke', null);\n            }\n          }\n        }\n      });\n    }\n  };\n  // 获取 itemWidth 的最终设置\n  Category.prototype.getLimitItemWidth = function () {\n    var itemWidth = this.get('itemWidth');\n    var maxItemWidth = this.get('maxItemWidth');\n    if (maxItemWidth) {\n      // 设置了最大宽度\n      if (itemWidth) {\n        maxItemWidth = itemWidth <= maxItemWidth ? itemWidth : maxItemWidth;\n      }\n    } else if (itemWidth) {\n      maxItemWidth = itemWidth;\n    }\n    return maxItemWidth;\n  };\n  return Category;\n}(LegendBase);\nexport default Category;","map":{"version":3,"names":["__assign","__extends","__rest","clamp","deepMix","each","filter","get","mix","isNumber","isFunction","ellipsisLabel","getMatrixByAngle","getMatrixByTranslate","getStatesStyle","Theme","LegendBase","DEFAULT_PAGE_NAVIGATOR","marker","style","inactiveFill","inactiveOpacity","fill","opacity","size","text","fontSize","textStyle","textColor","textAlign","textBaseline","fontFamily","fontWeight","lineHeight","RIGHT_ARROW_NAME","LEFT_ARROW_NAME","ROTATE_MAP","right","Math","PI","left","up","down","Category","_super","_this","apply","arguments","currentPageIndex","totalPagesCnt","pageWidth","pageHeight","startX","startY","onNavigationBack","itemGroup","getElementByLocalId","updateNavigation","matrix","getCurrentNavigationMatrix","animate","attr","onNavigationAfter","prototype","getDefaultCfg","cfg","call","name","type","itemSpacing","itemMarginBottom","maxItemWidth","itemWidth","itemHeight","itemName","itemValue","maxWidth","maxHeight","radio","items","itemStates","itemBackground","pageNavigator","defaultCfg","title","spacing","background","padding","stroke","lineColor","r","symbol","alignRight","formatter","active","nameStyle","unchecked","uncheckedColor","markerStyle","inactive","isList","getItems","setItems","update","updateItem","item","clear","render","clearItems","setItemState","state","value","itemElement","id","index","indexOf","offsetGroup","createOffScreenGroup","newElement","drawItem","getItemHeight","updateElements","clearUpdateStatus","hasState","getItemStates","rst","v","k","push","clearItemsState","getItemsByState","drawLegendContent","group","processItems","drawItems","itemContainerGroup","addGroup","getElementId","currentPoint","x","y","layout","wrapped","subGroup","bbox","getBBox","width","moveElementTo","adjustNavigation","style_1","items_1","forEach","drawMarker","container","markerCfg","markerAttrs","shape","addShape","attrs","_a","set","drawItemText","textName","xPosition","drawRadio","radioCfg","_b","lineWidth","_c","x0","y0","_d","x1","y1","_e","x2","y2","_f","x3","y3","showRadio","path","radioShape","tip","groupId","subContainer","delegateObject","getLimitItemWidth","curX","markerShape","itemMarkerSpacing","maxX","nameShape","valueShape","backShape","height","toBack","applyItemStates","subGroups","findAll","navigation","drawNavigation","navigationBBox","pages","widthLimit","shouldWrap","newItemXPos","maxRow","maxRowHeight_1","navigationX_1","minX","minY","getParent","setClip","min","max","cntPerPage_1","floor","ceil","styleCfg","arrowStyle","leftArrow","drawArrow","on","leftArrowBBox","textShape","textBBox","rightArrow","getChildren","findById","cursorX","updateArrowPath","direction","cursor","arrow","point","translate","states","hasStates","length","children","itemStates_1","element","elName","split","statesStyle"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@antv/component/esm/legend/category.js"],"sourcesContent":["import { __assign, __extends, __rest } from \"tslib\";\nimport { clamp, deepMix, each, filter, get, mix, isNumber, isFunction } from '@antv/util';\nimport { ellipsisLabel } from '../util/label';\nimport { getMatrixByAngle, getMatrixByTranslate } from '../util/matrix';\nimport { getStatesStyle } from '../util/state';\nimport Theme from '../util/theme';\nimport LegendBase from './base';\n/**\n * 分页器 默认配置\n */\nvar DEFAULT_PAGE_NAVIGATOR = {\n    marker: {\n        style: {\n            inactiveFill: '#000',\n            inactiveOpacity: 0.45,\n            fill: '#000',\n            opacity: 1,\n            size: 12,\n        },\n    },\n    text: {\n        style: {\n            fill: '#ccc',\n            fontSize: 12,\n        },\n    },\n};\n// 默认 文本style\nvar textStyle = {\n    fill: Theme.textColor,\n    fontSize: 12,\n    textAlign: 'start',\n    textBaseline: 'middle',\n    fontFamily: Theme.fontFamily,\n    fontWeight: 'normal',\n    lineHeight: 12,\n};\nvar RIGHT_ARROW_NAME = 'navigation-arrow-right';\nvar LEFT_ARROW_NAME = 'navigation-arrow-left';\nvar ROTATE_MAP = {\n    right: (90 * Math.PI) / 180,\n    left: ((360 - 90) * Math.PI) / 180,\n    up: 0,\n    down: (180 * Math.PI) / 180,\n};\nvar Category = /** @class */ (function (_super) {\n    __extends(Category, _super);\n    function Category() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.currentPageIndex = 1;\n        _this.totalPagesCnt = 1;\n        _this.pageWidth = 0;\n        _this.pageHeight = 0;\n        _this.startX = 0;\n        _this.startY = 0;\n        _this.onNavigationBack = function () {\n            var itemGroup = _this.getElementByLocalId('item-group');\n            if (_this.currentPageIndex > 1) {\n                _this.currentPageIndex -= 1;\n                _this.updateNavigation();\n                var matrix = _this.getCurrentNavigationMatrix();\n                if (_this.get('animate')) {\n                    itemGroup.animate({\n                        matrix: matrix,\n                    }, 100);\n                }\n                else {\n                    itemGroup.attr({ matrix: matrix });\n                }\n            }\n        };\n        _this.onNavigationAfter = function () {\n            var itemGroup = _this.getElementByLocalId('item-group');\n            if (_this.currentPageIndex < _this.totalPagesCnt) {\n                _this.currentPageIndex += 1;\n                _this.updateNavigation();\n                var matrix = _this.getCurrentNavigationMatrix();\n                if (_this.get('animate')) {\n                    itemGroup.animate({\n                        matrix: matrix,\n                    }, 100);\n                }\n                else {\n                    itemGroup.attr({ matrix: matrix });\n                }\n            }\n        };\n        return _this;\n    }\n    Category.prototype.getDefaultCfg = function () {\n        var cfg = _super.prototype.getDefaultCfg.call(this);\n        return __assign(__assign({}, cfg), { name: 'legend', type: 'category', itemSpacing: 24, itemMarginBottom: 8, maxItemWidth: null, itemWidth: null, itemHeight: null, itemName: {}, itemValue: null, maxWidth: null, maxHeight: null, marker: {}, radio: null, items: [], itemStates: {}, itemBackground: {}, pageNavigator: {}, defaultCfg: {\n                title: {\n                    spacing: 5,\n                    style: {\n                        fill: Theme.textColor,\n                        fontSize: 12,\n                        textAlign: 'start',\n                        textBaseline: 'top',\n                    },\n                },\n                background: {\n                    padding: 5,\n                    style: {\n                        stroke: Theme.lineColor,\n                    },\n                },\n                itemBackground: {\n                    style: {\n                        opacity: 0,\n                        fill: '#fff',\n                    },\n                },\n                pageNavigator: DEFAULT_PAGE_NAVIGATOR,\n                itemName: {\n                    spacing: 16,\n                    style: textStyle,\n                },\n                marker: {\n                    spacing: 8,\n                    style: {\n                        r: 6,\n                        symbol: 'circle',\n                    },\n                },\n                itemValue: {\n                    alignRight: false,\n                    formatter: null,\n                    style: textStyle,\n                    spacing: 6,\n                },\n                itemStates: {\n                    active: {\n                        nameStyle: {\n                            opacity: 0.8,\n                        },\n                    },\n                    unchecked: {\n                        nameStyle: {\n                            fill: Theme.uncheckedColor,\n                        },\n                        markerStyle: {\n                            fill: Theme.uncheckedColor,\n                            stroke: Theme.uncheckedColor,\n                        },\n                    },\n                    inactive: {\n                        nameStyle: {\n                            fill: Theme.uncheckedColor,\n                        },\n                        markerStyle: {\n                            opacity: 0.2,\n                        },\n                    },\n                },\n            } });\n    };\n    // 实现 IList 接口\n    Category.prototype.isList = function () {\n        return true;\n    };\n    /**\n     * 获取图例项\n     * @return {ListItem[]} 列表项集合\n     */\n    Category.prototype.getItems = function () {\n        return this.get('items');\n    };\n    /**\n     * 设置列表项\n     * @param {ListItem[]} items 列表项集合\n     */\n    Category.prototype.setItems = function (items) {\n        this.update({\n            items: items,\n        });\n    };\n    /**\n     * 更新列表项\n     * @param {ListItem} item 列表项\n     * @param {object}   cfg  列表项\n     */\n    Category.prototype.updateItem = function (item, cfg) {\n        mix(item, cfg);\n        this.clear(); // 由于单个图例项变化，会引起全局变化，所以全部更新\n        this.render();\n    };\n    /**\n     * 清空列表\n     */\n    Category.prototype.clearItems = function () {\n        var itemGroup = this.getElementByLocalId('item-group');\n        itemGroup && itemGroup.clear();\n    };\n    /**\n     * 设置列表项的状态\n     * @param {ListItem} item  列表项\n     * @param {string}   state 状态名\n     * @param {boolean}  value 状态值, true, false\n     */\n    Category.prototype.setItemState = function (item, state, value) {\n        item[state] = value;\n        var itemElement = this.getElementByLocalId(\"item-\" + item.id);\n        if (itemElement) {\n            var items = this.getItems();\n            var index = items.indexOf(item);\n            var offsetGroup = this.createOffScreenGroup(); // 离屏的 group\n            var newElement = this.drawItem(item, index, this.getItemHeight(), offsetGroup);\n            this.updateElements(newElement, itemElement); // 更新整个分组\n            this.clearUpdateStatus(itemElement); // 清理更新状态，防止出现 bug\n        }\n    };\n    /**\n     * 是否存在指定的状态\n     * @param {ListItem} item  列表项\n     * @param {boolean} state 状态名\n     */\n    Category.prototype.hasState = function (item, state) {\n        return !!item[state];\n    };\n    Category.prototype.getItemStates = function (item) {\n        var itemStates = this.get('itemStates');\n        var rst = [];\n        each(itemStates, function (v, k) {\n            if (item[k]) {\n                // item.selected\n                rst.push(k);\n            }\n        });\n        return rst;\n    };\n    /**\n     * 清楚所有列表项的状态\n     * @param {string} state 状态值\n     */\n    Category.prototype.clearItemsState = function (state) {\n        var _this = this;\n        var items = this.getItemsByState(state);\n        each(items, function (item) {\n            _this.setItemState(item, state, false);\n        });\n    };\n    /**\n     * 根据状态获取图例项\n     * @param  {string}     state [description]\n     * @return {ListItem[]}       [description]\n     */\n    Category.prototype.getItemsByState = function (state) {\n        var _this = this;\n        var items = this.getItems();\n        return filter(items, function (item) {\n            return _this.hasState(item, state);\n        });\n    };\n    // 绘制 legend 的选项\n    Category.prototype.drawLegendContent = function (group) {\n        this.processItems();\n        this.drawItems(group);\n    };\n    // 防止未设置 id\n    Category.prototype.processItems = function () {\n        var items = this.get('items');\n        each(items, function (item) {\n            if (!item.id) {\n                // 如果没有设置 id，默认使用 name\n                item.id = item.name;\n            }\n        });\n    };\n    // 绘制所有的图例选项\n    Category.prototype.drawItems = function (group) {\n        var _this = this;\n        var itemContainerGroup = this.addGroup(group, {\n            id: this.getElementId('item-container-group'),\n            name: 'legend-item-container-group',\n        });\n        var itemGroup = this.addGroup(itemContainerGroup, {\n            id: this.getElementId('item-group'),\n            name: 'legend-item-group',\n        });\n        var itemHeight = this.getItemHeight();\n        var itemWidth = this.get('itemWidth');\n        var itemSpacing = this.get('itemSpacing');\n        var itemMarginBottom = this.get('itemMarginBottom');\n        var currentPoint = this.get('currentPoint');\n        var startX = currentPoint.x;\n        var startY = currentPoint.y;\n        var layout = this.get('layout');\n        var items = this.get('items');\n        var wrapped = false;\n        var pageWidth = 0;\n        var maxWidth = this.get('maxWidth'); // 最大宽度，会导致 layout : 'horizontal' 时自动换行\n        var maxHeight = this.get('maxHeight'); // 最大高度，会导致出现分页\n        // 暂时不考虑分页\n        each(items, function (item, index) {\n            var subGroup = _this.drawItem(item, index, itemHeight, itemGroup);\n            var bbox = subGroup.getBBox();\n            var width = itemWidth || bbox.width;\n            if (width > pageWidth) {\n                pageWidth = width;\n            }\n            if (layout === 'horizontal') {\n                // 如果水平布局\n                if (maxWidth && maxWidth < currentPoint.x + width - startX) {\n                    // 检测是否换行\n                    wrapped = true;\n                    currentPoint.x = startX;\n                    currentPoint.y += itemHeight + itemMarginBottom;\n                }\n                _this.moveElementTo(subGroup, currentPoint);\n                currentPoint.x += width + itemSpacing;\n            }\n            else {\n                // 如果垂直布局\n                if (maxHeight && maxHeight < currentPoint.y + itemHeight + itemMarginBottom - startY) {\n                    // 换行\n                    wrapped = true;\n                    currentPoint.x += pageWidth + itemSpacing;\n                    currentPoint.y = startY;\n                    pageWidth = 0;\n                }\n                _this.moveElementTo(subGroup, currentPoint);\n                currentPoint.y += itemHeight + itemMarginBottom; // itemSpacing 仅影响水平间距\n            }\n        });\n        if (wrapped && this.get('flipPage')) {\n            this.pageHeight = 0;\n            this.pageWidth = 0;\n            this.totalPagesCnt = 1;\n            this.startX = startX;\n            this.startY = startY;\n            this.adjustNavigation(group, itemGroup);\n        }\n    };\n    // 获取图例项的高度，如果未定义，则按照 name 的高度计算\n    Category.prototype.getItemHeight = function () {\n        var itemHeight = this.get('itemHeight');\n        if (!itemHeight) {\n            var style_1 = (this.get('itemName') || {}).style;\n            if (isFunction(style_1)) {\n                var items_1 = this.getItems();\n                items_1.forEach(function (item, index) {\n                    var fontSize = __assign(__assign({}, textStyle), style_1(item, index, items_1)).fontSize;\n                    if (itemHeight < fontSize) {\n                        itemHeight = fontSize;\n                    }\n                });\n            }\n            else if (style_1) {\n                itemHeight = style_1.fontSize;\n            }\n        }\n        return itemHeight;\n    };\n    // 绘制 marker\n    Category.prototype.drawMarker = function (container, markerCfg, item, itemHeight) {\n        var markerAttrs = __assign(__assign(__assign({ x: 0, y: itemHeight / 2 }, markerCfg.style), { symbol: get(item.marker, 'symbol', 'circle') }), get(item.marker, 'style', {}));\n        var shape = this.addShape(container, {\n            type: 'marker',\n            id: this.getElementId(\"item-\" + item.id + \"-marker\"),\n            name: 'legend-item-marker',\n            attrs: markerAttrs,\n        });\n        var bbox = shape.getBBox();\n        shape.attr('x', bbox.width / 2); // marker 需要左对齐，所以不能占用左侧的空间\n        var _a = shape.attr(), stroke = _a.stroke, fill = _a.fill;\n        if (stroke) {\n            shape.set('isStroke', true);\n        }\n        if (fill) {\n            shape.set('isFill', true);\n        }\n        return shape;\n    };\n    // 绘制文本\n    Category.prototype.drawItemText = function (container, textName, cfg, item, itemHeight, xPosition, index) {\n        var formatter = cfg.formatter;\n        var style = cfg.style;\n        var attrs = __assign(__assign({ x: xPosition, y: itemHeight / 2, text: formatter ? formatter(item[textName], item, index) : item[textName] }, textStyle), (isFunction(style) ? style(item, index, this.getItems()) : style));\n        return this.addShape(container, {\n            type: 'text',\n            id: this.getElementId(\"item-\" + item.id + \"-\" + textName),\n            name: \"legend-item-\" + textName,\n            attrs: attrs,\n        });\n    };\n    Category.prototype.drawRadio = function (container, radioCfg, item, itemHeight, x) {\n        var _a, _b;\n        var style = radioCfg.style || {};\n        // 以用户设置的 r 为主\n        var r = (_a = style.r) !== null && _a !== void 0 ? _a : itemHeight / 2;\n        var lineWidth = (r * 3.6) / 8;\n        var _c = [x + r, itemHeight / 2 - r], x0 = _c[0], y0 = _c[1];\n        var _d = [x0 + r, y0 + r], x1 = _d[0], y1 = _d[1];\n        var _e = [x0, y1 + r], x2 = _e[0], y2 = _e[1];\n        var _f = [x, y0 + r], x3 = _f[0], y3 = _f[1];\n        var showRadio = item.showRadio;\n        var attrs = __assign(__assign({ path: [\n                ['M', x0, y0],\n                ['A', r, r, 0, 0, 1, x1, y1],\n                ['L', x1 - lineWidth, y1],\n                ['L', x1, y1],\n                ['A', r, r, 0, 0, 1, x2, y2],\n                ['L', x2, y2 - lineWidth],\n                ['L', x2, y2],\n                ['A', r, r, 0, 0, 1, x3, y3],\n                ['L', x3 + lineWidth, y3],\n                ['L', x3, y3],\n                ['A', r, r, 0, 0, 1, x0, y0],\n                ['L', x0, y0 + lineWidth],\n            ], stroke: '#000000', fill: '#ffffff' }, style), { opacity: showRadio ? ((_b = style === null || style === void 0 ? void 0 : style.opacity) !== null && _b !== void 0 ? _b : 0.45) : 0 });\n        var radioShape = this.addShape(container, {\n            type: 'path',\n            id: this.getElementId(\"item-\" + item.id + \"-radio\"),\n            name: 'legend-item-radio',\n            attrs: attrs,\n        });\n        radioShape.set('tip', radioCfg.tip);\n        return radioShape;\n    };\n    // 绘制图例项\n    Category.prototype.drawItem = function (item, index, itemHeight, itemGroup) {\n        var groupId = \"item-\" + item.id;\n        // 设置单独的 Group 用于 setClip\n        var subContainer = this.addGroup(itemGroup, {\n            name: 'legend-item-container',\n            id: this.getElementId(\"item-container-\" + groupId),\n            delegateObject: {\n                item: item,\n                index: index,\n            },\n        });\n        var subGroup = this.addGroup(subContainer, {\n            name: 'legend-item',\n            id: this.getElementId(groupId),\n            delegateObject: {\n                item: item,\n                index: index,\n            },\n        });\n        var marker = this.get('marker');\n        var itemName = this.get('itemName');\n        var itemValue = this.get('itemValue');\n        var itemBackground = this.get('itemBackground');\n        var radio = this.get('radio');\n        var itemWidth = this.getLimitItemWidth();\n        var curX = 0; // 记录当前 x 的位置\n        if (marker) {\n            var markerShape = this.drawMarker(subGroup, marker, item, itemHeight);\n            var spacing = marker.spacing;\n            var itemMarkerSpacing = get(item, ['marker', 'spacing']);\n            if (isNumber(itemMarkerSpacing)) {\n                // 如果 item 有配置 marker.spacing，采用 item 的配置\n                spacing = itemMarkerSpacing;\n            }\n            curX = markerShape.getBBox().maxX + spacing;\n        }\n        if (itemName) {\n            var nameShape = this.drawItemText(subGroup, 'name', itemName, item, itemHeight, curX, index);\n            if (itemWidth) {\n                // 设置了 item 的最大宽度限制，并且超出了，进行省略处理\n                ellipsisLabel(true, nameShape, clamp(itemWidth - curX, 0, itemWidth));\n            }\n            curX = nameShape.getBBox().maxX + itemName.spacing;\n        }\n        if (itemValue) {\n            var valueShape = this.drawItemText(subGroup, 'value', itemValue, item, itemHeight, curX, index);\n            if (itemWidth) {\n                if (itemValue.alignRight) {\n                    valueShape.attr({\n                        textAlign: 'right',\n                        x: itemWidth,\n                    });\n                    ellipsisLabel(true, valueShape, clamp(itemWidth - curX, 0, itemWidth), 'head');\n                }\n                else {\n                    ellipsisLabel(true, valueShape, clamp(itemWidth - curX, 0, itemWidth));\n                }\n            }\n            curX = valueShape.getBBox().maxX + itemValue.spacing;\n        }\n        if (radio) {\n            this.drawRadio(subGroup, radio, item, itemHeight, curX);\n        }\n        // 添加透明的背景，便于拾取和包围盒计算\n        if (itemBackground) {\n            var bbox = subGroup.getBBox();\n            var backShape = this.addShape(subGroup, {\n                type: 'rect',\n                name: 'legend-item-background',\n                id: this.getElementId(groupId + \"-background\"),\n                attrs: __assign({ x: 0, y: 0, width: bbox.width, height: itemHeight }, itemBackground.style),\n            });\n            backShape.toBack();\n        }\n        this.applyItemStates(item, subGroup);\n        return subGroup;\n    };\n    // 加上分页器并重新排序 items\n    Category.prototype.adjustNavigation = function (container, itemGroup) {\n        var _this = this;\n        var startX = this.startX;\n        var startY = this.startY;\n        var layout = this.get('layout');\n        var subGroups = itemGroup.findAll(function (item) { return item.get('name') === 'legend-item'; });\n        var maxWidth = this.get('maxWidth');\n        var maxHeight = this.get('maxHeight');\n        var itemWidth = this.get('itemWidth');\n        var itemSpacing = this.get('itemSpacing');\n        var itemHeight = this.getItemHeight();\n        var pageNavigator = deepMix({}, DEFAULT_PAGE_NAVIGATOR, this.get('pageNavigator'));\n        var navigation = this.drawNavigation(container, layout, '00/00', pageNavigator);\n        var navigationBBox = navigation.getBBox();\n        var currentPoint = { x: startX, y: startY };\n        var pages = 1;\n        var widthLimit = 0;\n        var pageWidth = 0;\n        var maxItemWidth = 0;\n        var itemMarginBottom = this.get('itemMarginBottom');\n        /**  判断当前 item 是否溢出当前页。是的话，需要换行 */\n        function shouldWrap(item, currentPoint) {\n            var bbox = item.getBBox();\n            var width = itemWidth || bbox.width;\n            var newItemXPos = currentPoint.x + width + itemSpacing + navigationBBox.width;\n            return newItemXPos > maxWidth;\n        }\n        if (layout === 'horizontal') {\n            var maxRow = this.get('maxRow') || 1;\n            var maxRowHeight_1 = itemHeight + (maxRow === 1 ? 0 : itemMarginBottom);\n            // 分页器一直靠右上角\n            var navigationX_1 = maxWidth - itemSpacing - navigationBBox.width - navigationBBox.minX; // 理论上不需要减 navigationBBox.minX\n            this.pageHeight = maxRowHeight_1 * maxRow;\n            this.pageWidth = navigationX_1;\n            each(subGroups, function (item) {\n                var bbox = item.getBBox();\n                var width = itemWidth || bbox.width;\n                if ((widthLimit && widthLimit < currentPoint.x + width + itemSpacing) ||\n                    shouldWrap(item, currentPoint)) {\n                    if (pages === 1) {\n                        widthLimit = currentPoint.x + itemSpacing;\n                        _this.moveElementTo(navigation, {\n                            x: navigationX_1,\n                            y: currentPoint.y + itemHeight / 2 - navigationBBox.height / 2 - navigationBBox.minY,\n                        });\n                    }\n                    pages += 1;\n                    currentPoint.x = startX;\n                    currentPoint.y += maxRowHeight_1;\n                }\n                _this.moveElementTo(item, currentPoint);\n                item.getParent().setClip({\n                    type: 'rect',\n                    attrs: {\n                        x: currentPoint.x,\n                        y: currentPoint.y,\n                        width: width + itemSpacing,\n                        height: itemHeight,\n                    },\n                });\n                currentPoint.x += width + itemSpacing;\n            });\n        }\n        else {\n            each(subGroups, function (item) {\n                var bbox = item.getBBox();\n                if (bbox.width > pageWidth) {\n                    pageWidth = bbox.width;\n                }\n            });\n            maxItemWidth = pageWidth;\n            pageWidth += itemSpacing;\n            if (maxWidth) {\n                // maxWidth 限制加上\n                pageWidth = Math.min(maxWidth, pageWidth);\n                maxItemWidth = Math.min(maxWidth, maxItemWidth);\n            }\n            this.pageWidth = pageWidth;\n            this.pageHeight = maxHeight - Math.max(navigationBBox.height, itemHeight + itemMarginBottom);\n            var cntPerPage_1 = Math.floor(this.pageHeight / (itemHeight + itemMarginBottom));\n            each(subGroups, function (item, index) {\n                if (index !== 0 && index % cntPerPage_1 === 0) {\n                    pages += 1;\n                    currentPoint.x += pageWidth;\n                    currentPoint.y = startY;\n                }\n                _this.moveElementTo(item, currentPoint);\n                item.getParent().setClip({\n                    type: 'rect',\n                    attrs: {\n                        x: currentPoint.x,\n                        y: currentPoint.y,\n                        width: pageWidth,\n                        height: itemHeight,\n                    },\n                });\n                currentPoint.y += itemHeight + itemMarginBottom;\n            });\n            this.totalPagesCnt = pages;\n            this.moveElementTo(navigation, {\n                x: startX + maxItemWidth / 2 - navigationBBox.width / 2 - navigationBBox.minX,\n                y: maxHeight - navigationBBox.height - navigationBBox.minY,\n            });\n        }\n        if (this.pageHeight && this.pageWidth) {\n            // 为了使固定的 clip 生效，clip 设置在 itemContainerGroup 上，itemGroup 需要在翻页时会设置 matrix\n            itemGroup.getParent().setClip({\n                type: 'rect',\n                attrs: {\n                    x: this.startX,\n                    y: this.startY,\n                    width: this.pageWidth,\n                    height: this.pageHeight,\n                },\n            });\n        }\n        // 重新计算 totalPagesCnt\n        if (layout === 'horizontal' && this.get('maxRow')) {\n            this.totalPagesCnt = Math.ceil(pages / this.get('maxRow'));\n        }\n        else {\n            this.totalPagesCnt = pages;\n        }\n        if (this.currentPageIndex > this.totalPagesCnt) {\n            this.currentPageIndex = 1;\n        }\n        this.updateNavigation(navigation);\n        // update initial matrix\n        itemGroup.attr('matrix', this.getCurrentNavigationMatrix());\n    };\n    /**\n     * 绘制分页器\n     */\n    Category.prototype.drawNavigation = function (group, layout, text, styleCfg) {\n        var currentPoint = { x: 0, y: 0 };\n        var subGroup = this.addGroup(group, {\n            id: this.getElementId('navigation-group'),\n            name: 'legend-navigation',\n        });\n        var _a = get(styleCfg.marker, 'style', {}), _b = _a.size, size = _b === void 0 ? 12 : _b, arrowStyle = __rest(_a, [\"size\"]);\n        var leftArrow = this.drawArrow(subGroup, currentPoint, LEFT_ARROW_NAME, layout === 'horizontal' ? 'up' : 'left', size, arrowStyle);\n        leftArrow.on('click', this.onNavigationBack);\n        var leftArrowBBox = leftArrow.getBBox();\n        currentPoint.x += leftArrowBBox.width + 2;\n        var textShape = this.addShape(subGroup, {\n            type: 'text',\n            id: this.getElementId('navigation-text'),\n            name: 'navigation-text',\n            attrs: __assign({ x: currentPoint.x, y: currentPoint.y + size / 2, text: text, textBaseline: 'middle' }, get(styleCfg.text, 'style')),\n        });\n        var textBBox = textShape.getBBox();\n        currentPoint.x += textBBox.width + 2;\n        var rightArrow = this.drawArrow(subGroup, currentPoint, RIGHT_ARROW_NAME, layout === 'horizontal' ? 'down' : 'right', size, arrowStyle);\n        rightArrow.on('click', this.onNavigationAfter);\n        return subGroup;\n    };\n    Category.prototype.updateNavigation = function (navigation) {\n        var pageNavigator = deepMix({}, DEFAULT_PAGE_NAVIGATOR, this.get('pageNavigator'));\n        var _a = pageNavigator.marker.style, fill = _a.fill, opacity = _a.opacity, inactiveFill = _a.inactiveFill, inactiveOpacity = _a.inactiveOpacity;\n        var text = this.currentPageIndex + \"/\" + this.totalPagesCnt;\n        var textShape = navigation ? navigation.getChildren()[1] : this.getElementByLocalId('navigation-text');\n        var leftArrow = navigation\n            ? navigation.findById(this.getElementId(LEFT_ARROW_NAME))\n            : this.getElementByLocalId(LEFT_ARROW_NAME);\n        var rightArrow = navigation\n            ? navigation.findById(this.getElementId(RIGHT_ARROW_NAME))\n            : this.getElementByLocalId(RIGHT_ARROW_NAME);\n        textShape.attr('text', text);\n        // 更新 left-arrow marker\n        leftArrow.attr('opacity', this.currentPageIndex === 1 ? inactiveOpacity : opacity);\n        leftArrow.attr('fill', this.currentPageIndex === 1 ? inactiveFill : fill);\n        leftArrow.attr('cursor', this.currentPageIndex === 1 ? 'not-allowed' : 'pointer');\n        // 更新 right-arrow marker\n        rightArrow.attr('opacity', this.currentPageIndex === this.totalPagesCnt ? inactiveOpacity : opacity);\n        rightArrow.attr('fill', this.currentPageIndex === this.totalPagesCnt ? inactiveFill : fill);\n        rightArrow.attr('cursor', this.currentPageIndex === this.totalPagesCnt ? 'not-allowed' : 'pointer');\n        // 更新位置\n        var cursorX = leftArrow.getBBox().maxX + 2;\n        textShape.attr('x', cursorX);\n        cursorX += textShape.getBBox().width + 2;\n        this.updateArrowPath(rightArrow, { x: cursorX, y: 0 });\n    };\n    Category.prototype.drawArrow = function (group, currentPoint, name, direction, size, style) {\n        var x = currentPoint.x, y = currentPoint.y;\n        var shape = this.addShape(group, {\n            type: 'path',\n            id: this.getElementId(name),\n            name: name,\n            attrs: __assign({ size: size,\n                direction: direction, path: [['M', x + size / 2, y], ['L', x, y + size], ['L', x + size, y + size], ['Z']], cursor: 'pointer' }, style),\n        });\n        shape.attr('matrix', getMatrixByAngle({ x: x + size / 2, y: y + size / 2 }, ROTATE_MAP[direction]));\n        return shape;\n    };\n    /**\n     * 更新分页器 arrow 组件\n     */\n    Category.prototype.updateArrowPath = function (arrow, point) {\n        var x = point.x, y = point.y;\n        var _a = arrow.attr(), size = _a.size, direction = _a.direction;\n        var matrix = getMatrixByAngle({ x: x + size / 2, y: y + size / 2 }, ROTATE_MAP[direction]);\n        arrow.attr('path', [['M', x + size / 2, y], ['L', x, y + size], ['L', x + size, y + size], ['Z']]);\n        arrow.attr('matrix', matrix);\n    };\n    Category.prototype.getCurrentNavigationMatrix = function () {\n        var _a = this, currentPageIndex = _a.currentPageIndex, pageWidth = _a.pageWidth, pageHeight = _a.pageHeight;\n        var layout = this.get('layout');\n        var translate = layout === 'horizontal'\n            ? {\n                x: 0,\n                y: pageHeight * (1 - currentPageIndex),\n            }\n            : {\n                x: pageWidth * (1 - currentPageIndex),\n                y: 0,\n            };\n        return getMatrixByTranslate(translate);\n    };\n    // 附加状态对应的样式\n    Category.prototype.applyItemStates = function (item, subGroup) {\n        var states = this.getItemStates(item);\n        var hasStates = states.length > 0;\n        if (hasStates) {\n            var children = subGroup.getChildren();\n            var itemStates_1 = this.get('itemStates');\n            each(children, function (element) {\n                var name = element.get('name');\n                var elName = name.split('-')[2]; // marker, name, value\n                var statesStyle = getStatesStyle(item, elName, itemStates_1);\n                if (statesStyle) {\n                    element.attr(statesStyle);\n                    if (elName === 'marker' && !(element.get('isStroke') && element.get('isFill'))) {\n                        // 如果 marker 是单填充或者单描边的话，就不要额外添加 stroke 或这 fill 属性，否则会影响 unchecked 后的显示\n                        if (element.get('isStroke')) {\n                            element.attr('fill', null);\n                        }\n                        if (element.get('isFill')) {\n                            element.attr('stroke', null);\n                        }\n                    }\n                }\n            });\n        }\n    };\n    // 获取 itemWidth 的最终设置\n    Category.prototype.getLimitItemWidth = function () {\n        var itemWidth = this.get('itemWidth');\n        var maxItemWidth = this.get('maxItemWidth');\n        if (maxItemWidth) {\n            // 设置了最大宽度\n            if (itemWidth) {\n                maxItemWidth = itemWidth <= maxItemWidth ? itemWidth : maxItemWidth;\n            }\n        }\n        else if (itemWidth) {\n            maxItemWidth = itemWidth;\n        }\n        return maxItemWidth;\n    };\n    return Category;\n}(LegendBase));\nexport default Category;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}