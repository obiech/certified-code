{"ast":null,"code":"import { each, pick } from '@antv/util';\nimport { getCoordinateBBox } from '../../../util/coordinate';\nimport { getEllipsisText } from '../../../util/text';\nimport { translate } from '../../../util/transform';\n/**\n * @ignore\n * 将 label 限制在 Plot 范围内，将超出 Plot 范围的 label 可选择进行隐藏或者移动位置\n * @param labels\n * @param cfg\n */\nexport function limitInPlot(items, labels, shapes, region, cfg) {\n  if (labels.length <= 0) {\n    return;\n  }\n  var direction = (cfg === null || cfg === void 0 ? void 0 : cfg.direction) || ['top', 'right', 'bottom', 'left'];\n  var action = (cfg === null || cfg === void 0 ? void 0 : cfg.action) || 'translate';\n  var margin = (cfg === null || cfg === void 0 ? void 0 : cfg.margin) || 0;\n  var coordinate = labels[0].get('coordinate');\n  if (!coordinate) {\n    return;\n  }\n  var _a = getCoordinateBBox(coordinate, margin),\n    regionMinX = _a.minX,\n    regionMinY = _a.minY,\n    regionMaxX = _a.maxX,\n    regionMaxY = _a.maxY;\n  each(labels, function (label) {\n    var _a = label.getCanvasBBox(),\n      minX = _a.minX,\n      minY = _a.minY,\n      maxX = _a.maxX,\n      maxY = _a.maxY,\n      x = _a.x,\n      y = _a.y,\n      width = _a.width,\n      height = _a.height;\n    var finalX = x;\n    var finalY = y;\n    if (direction.indexOf('left') >= 0 && (minX < regionMinX || maxX < regionMinX)) {\n      // 超出左侧\n      finalX = regionMinX;\n    }\n    if (direction.indexOf('top') >= 0 && (minY < regionMinY || maxY < regionMinY)) {\n      // 超出顶部\n      finalY = regionMinY;\n    }\n    if (direction.indexOf('right') >= 0) {\n      if (minX > regionMaxX) {\n        // 整体超出右侧\n        finalX = regionMaxX - width;\n      } else if (maxX > regionMaxX) {\n        // 超出右侧\n        finalX = finalX - (maxX - regionMaxX);\n      }\n    }\n    if (direction.indexOf('bottom') >= 0) {\n      if (minY > regionMaxY) {\n        // 整体超出底部\n        finalY = regionMaxY - height;\n      } else if (maxY > regionMaxY) {\n        // 超出底部\n        finalY = finalY - (maxY - regionMaxY);\n      }\n    }\n    if (finalX !== x || finalY !== y) {\n      var translateX_1 = finalX - x;\n      if (action === 'translate') {\n        translate(label, translateX_1, finalY - y);\n      } else if (action === 'ellipsis') {\n        var textShapes = label.findAll(function (shape) {\n          return shape.get('type') === 'text';\n        });\n        textShapes.forEach(function (textShape) {\n          var style = pick(textShape.attr(), ['fontSize', 'fontFamily', 'fontWeight', 'fontStyle', 'fontVariant']);\n          var textBox = textShape.getCanvasBBox();\n          var text = getEllipsisText(textShape.attr('text'), textBox.width - Math.abs(translateX_1), style);\n          textShape.attr('text', text);\n        });\n      } else {\n        label.hide();\n      }\n    }\n  });\n}","map":{"version":3,"names":["each","pick","getCoordinateBBox","getEllipsisText","translate","limitInPlot","items","labels","shapes","region","cfg","length","direction","action","margin","coordinate","get","_a","regionMinX","minX","regionMinY","minY","regionMaxX","maxX","regionMaxY","maxY","label","getCanvasBBox","x","y","width","height","finalX","finalY","indexOf","translateX_1","textShapes","findAll","shape","forEach","textShape","style","attr","textBox","text","Math","abs","hide"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@antv/g2/esm/geometry/label/layout/limit-in-plot.js"],"sourcesContent":["import { each, pick } from '@antv/util';\nimport { getCoordinateBBox } from '../../../util/coordinate';\nimport { getEllipsisText } from '../../../util/text';\nimport { translate } from '../../../util/transform';\n/**\n * @ignore\n * 将 label 限制在 Plot 范围内，将超出 Plot 范围的 label 可选择进行隐藏或者移动位置\n * @param labels\n * @param cfg\n */\nexport function limitInPlot(items, labels, shapes, region, cfg) {\n    if (labels.length <= 0) {\n        return;\n    }\n    var direction = (cfg === null || cfg === void 0 ? void 0 : cfg.direction) || ['top', 'right', 'bottom', 'left'];\n    var action = (cfg === null || cfg === void 0 ? void 0 : cfg.action) || 'translate';\n    var margin = (cfg === null || cfg === void 0 ? void 0 : cfg.margin) || 0;\n    var coordinate = labels[0].get('coordinate');\n    if (!coordinate) {\n        return;\n    }\n    var _a = getCoordinateBBox(coordinate, margin), regionMinX = _a.minX, regionMinY = _a.minY, regionMaxX = _a.maxX, regionMaxY = _a.maxY;\n    each(labels, function (label) {\n        var _a = label.getCanvasBBox(), minX = _a.minX, minY = _a.minY, maxX = _a.maxX, maxY = _a.maxY, x = _a.x, y = _a.y, width = _a.width, height = _a.height;\n        var finalX = x;\n        var finalY = y;\n        if (direction.indexOf('left') >= 0 && (minX < regionMinX || maxX < regionMinX)) {\n            // 超出左侧\n            finalX = regionMinX;\n        }\n        if (direction.indexOf('top') >= 0 && (minY < regionMinY || maxY < regionMinY)) {\n            // 超出顶部\n            finalY = regionMinY;\n        }\n        if (direction.indexOf('right') >= 0) {\n            if (minX > regionMaxX) {\n                // 整体超出右侧\n                finalX = regionMaxX - width;\n            }\n            else if (maxX > regionMaxX) {\n                // 超出右侧\n                finalX = finalX - (maxX - regionMaxX);\n            }\n        }\n        if (direction.indexOf('bottom') >= 0) {\n            if (minY > regionMaxY) {\n                // 整体超出底部\n                finalY = regionMaxY - height;\n            }\n            else if (maxY > regionMaxY) {\n                // 超出底部\n                finalY = finalY - (maxY - regionMaxY);\n            }\n        }\n        if (finalX !== x || finalY !== y) {\n            var translateX_1 = finalX - x;\n            if (action === 'translate') {\n                translate(label, translateX_1, finalY - y);\n            }\n            else if (action === 'ellipsis') {\n                var textShapes = label.findAll(function (shape) { return shape.get('type') === 'text'; });\n                textShapes.forEach(function (textShape) {\n                    var style = pick(textShape.attr(), ['fontSize', 'fontFamily', 'fontWeight', 'fontStyle', 'fontVariant']);\n                    var textBox = textShape.getCanvasBBox();\n                    var text = getEllipsisText(textShape.attr('text'), textBox.width - Math.abs(translateX_1), style);\n                    textShape.attr('text', text);\n                });\n            }\n            else {\n                label.hide();\n            }\n        }\n    });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}