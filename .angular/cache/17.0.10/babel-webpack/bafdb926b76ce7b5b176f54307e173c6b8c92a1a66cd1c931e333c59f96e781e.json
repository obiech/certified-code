{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { each } from '@antv/util';\nimport { getElements, getIntersectElements, getMaskedElements, getSiblingMaskElements, getSilbings, isInRecords, isMask } from '../util';\nimport StateBase from './state-base';\n/**\n * @ignore\n * 区域设置状态的基础 Action\n */\nvar ElementRangeState = /** @class */function (_super) {\n  __extends(ElementRangeState, _super);\n  function ElementRangeState() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.startPoint = null;\n    _this.endPoint = null;\n    _this.isStarted = false;\n    /**\n     * 是否作用于当前 view 的 siblings，默认是 false 仅作用于自己\n     */\n    _this.effectSiblings = false;\n    /**\n     * 是否受 element 的数据影响，还是受包围盒的影响\n     */\n    _this.effectByRecord = false;\n    return _this;\n  }\n  // 获取当前的位置\n  ElementRangeState.prototype.getCurrentPoint = function () {\n    var event = this.context.event;\n    return {\n      x: event.x,\n      y: event.y\n    };\n  };\n  /**\n   * 开始，记录开始选中的位置\n   */\n  ElementRangeState.prototype.start = function () {\n    this.clear(); // 开始的时候清理之前的状态\n    this.startPoint = this.getCurrentPoint();\n    this.isStarted = true;\n  };\n  ElementRangeState.prototype.getIntersectElements = function () {\n    var elements = null;\n    if (isMask(this.context)) {\n      elements = getMaskedElements(this.context, 10);\n    } else {\n      var startPoint = this.startPoint;\n      var endPoint = this.isStarted ? this.getCurrentPoint() : this.endPoint;\n      // 如果没有开始，则不允许范围设置状态，保护性质\n      if (!startPoint || !endPoint) {\n        return;\n      }\n      // 计算框选区域\n      var box = {\n        minX: Math.min(startPoint.x, endPoint.x),\n        minY: Math.min(startPoint.y, endPoint.y),\n        maxX: Math.max(startPoint.x, endPoint.x),\n        maxY: Math.max(startPoint.y, endPoint.y)\n      };\n      // this.clear(); // 不全部清理，会导致闪烁\n      var view = this.context.view;\n      elements = getIntersectElements(view, box);\n    }\n    return elements;\n  };\n  /**\n   * 选中\n   */\n  ElementRangeState.prototype.setStateEnable = function (enable) {\n    if (this.effectSiblings && !this.effectByRecord) {\n      this.setSiblingsState(enable);\n    } else {\n      var allElements = getElements(this.context.view);\n      var elements = this.getIntersectElements();\n      if (elements && elements.length) {\n        if (this.effectByRecord) {\n          this.setSiblingsStateByRecord(elements, enable);\n        } else {\n          this.setElementsState(elements, enable, allElements);\n        }\n      } else {\n        this.clear();\n      }\n    }\n  };\n  // 根据选中的 element 的数据进行设置状态\n  ElementRangeState.prototype.setSiblingsStateByRecord = function (elements, enable) {\n    var _this = this;\n    var view = this.context.view;\n    var siblings = getSilbings(view);\n    var records = elements.map(function (el) {\n      return el.getModel().data;\n    });\n    var xFiled = view.getXScale().field;\n    var yField = view.getYScales()[0].field;\n    each(siblings, function (sibling) {\n      var allElements = getElements(sibling);\n      var effectElements = allElements.filter(function (el) {\n        var record = el.getModel().data;\n        return isInRecords(records, record, xFiled, yField);\n      });\n      _this.setElementsState(effectElements, enable, allElements);\n    });\n  };\n  // 设置兄弟 view 的状态\n  ElementRangeState.prototype.setSiblingsState = function (enable) {\n    var _this = this;\n    var view = this.context.view;\n    var siblings = getSilbings(view);\n    if (isMask(this.context)) {\n      // 受 mask 影响\n      each(siblings, function (sibling) {\n        var allElements = getElements(sibling);\n        var effectElements = getSiblingMaskElements(_this.context, sibling, 10);\n        if (effectElements && effectElements.length) {\n          _this.setElementsState(effectElements, enable, allElements);\n        } else {\n          _this.clearViewState(sibling);\n        }\n      });\n    }\n  };\n  ElementRangeState.prototype.setElementsState = function (elements, enable, allElements) {\n    var _this = this;\n    each(allElements, function (el) {\n      if (!elements.includes(el)) {\n        _this.setElementState(el, false);\n      } else {\n        _this.setElementState(el, enable);\n      }\n    });\n  };\n  /**\n   * 结束\n   */\n  ElementRangeState.prototype.end = function () {\n    this.isStarted = false;\n    this.endPoint = this.getCurrentPoint();\n  };\n  // 复写 clear\n  ElementRangeState.prototype.clear = function () {\n    var _this = this;\n    var view = this.context.view;\n    // 判断是否影响 siblings\n    if (this.effectSiblings) {\n      var siblings = getSilbings(view);\n      each(siblings, function (sibling) {\n        _this.clearViewState(sibling);\n      });\n    } else {\n      this.clearViewState(view);\n    }\n  };\n  return ElementRangeState;\n}(StateBase);\nexport default ElementRangeState;","map":{"version":3,"names":["__extends","each","getElements","getIntersectElements","getMaskedElements","getSiblingMaskElements","getSilbings","isInRecords","isMask","StateBase","ElementRangeState","_super","_this","apply","arguments","startPoint","endPoint","isStarted","effectSiblings","effectByRecord","prototype","getCurrentPoint","event","context","x","y","start","clear","elements","box","minX","Math","min","minY","maxX","max","maxY","view","setStateEnable","enable","setSiblingsState","allElements","length","setSiblingsStateByRecord","setElementsState","siblings","records","map","el","getModel","data","xFiled","getXScale","field","yField","getYScales","sibling","effectElements","filter","record","clearViewState","includes","setElementState","end"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@antv/g2/esm/interaction/action/element/range-state.js"],"sourcesContent":["import { __extends } from \"tslib\";\nimport { each } from '@antv/util';\nimport { getElements, getIntersectElements, getMaskedElements, getSiblingMaskElements, getSilbings, isInRecords, isMask, } from '../util';\nimport StateBase from './state-base';\n/**\n * @ignore\n * 区域设置状态的基础 Action\n */\nvar ElementRangeState = /** @class */ (function (_super) {\n    __extends(ElementRangeState, _super);\n    function ElementRangeState() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.startPoint = null;\n        _this.endPoint = null;\n        _this.isStarted = false;\n        /**\n         * 是否作用于当前 view 的 siblings，默认是 false 仅作用于自己\n         */\n        _this.effectSiblings = false;\n        /**\n         * 是否受 element 的数据影响，还是受包围盒的影响\n         */\n        _this.effectByRecord = false;\n        return _this;\n    }\n    // 获取当前的位置\n    ElementRangeState.prototype.getCurrentPoint = function () {\n        var event = this.context.event;\n        return {\n            x: event.x,\n            y: event.y,\n        };\n    };\n    /**\n     * 开始，记录开始选中的位置\n     */\n    ElementRangeState.prototype.start = function () {\n        this.clear(); // 开始的时候清理之前的状态\n        this.startPoint = this.getCurrentPoint();\n        this.isStarted = true;\n    };\n    ElementRangeState.prototype.getIntersectElements = function () {\n        var elements = null;\n        if (isMask(this.context)) {\n            elements = getMaskedElements(this.context, 10);\n        }\n        else {\n            var startPoint = this.startPoint;\n            var endPoint = this.isStarted ? this.getCurrentPoint() : this.endPoint;\n            // 如果没有开始，则不允许范围设置状态，保护性质\n            if (!startPoint || !endPoint) {\n                return;\n            }\n            // 计算框选区域\n            var box = {\n                minX: Math.min(startPoint.x, endPoint.x),\n                minY: Math.min(startPoint.y, endPoint.y),\n                maxX: Math.max(startPoint.x, endPoint.x),\n                maxY: Math.max(startPoint.y, endPoint.y),\n            };\n            // this.clear(); // 不全部清理，会导致闪烁\n            var view = this.context.view;\n            elements = getIntersectElements(view, box);\n        }\n        return elements;\n    };\n    /**\n     * 选中\n     */\n    ElementRangeState.prototype.setStateEnable = function (enable) {\n        if (this.effectSiblings && !this.effectByRecord) {\n            this.setSiblingsState(enable);\n        }\n        else {\n            var allElements = getElements(this.context.view);\n            var elements = this.getIntersectElements();\n            if (elements && elements.length) {\n                if (this.effectByRecord) {\n                    this.setSiblingsStateByRecord(elements, enable);\n                }\n                else {\n                    this.setElementsState(elements, enable, allElements);\n                }\n            }\n            else {\n                this.clear();\n            }\n        }\n    };\n    // 根据选中的 element 的数据进行设置状态\n    ElementRangeState.prototype.setSiblingsStateByRecord = function (elements, enable) {\n        var _this = this;\n        var view = this.context.view;\n        var siblings = getSilbings(view);\n        var records = elements.map(function (el) {\n            return el.getModel().data;\n        });\n        var xFiled = view.getXScale().field;\n        var yField = view.getYScales()[0].field;\n        each(siblings, function (sibling) {\n            var allElements = getElements(sibling);\n            var effectElements = allElements.filter(function (el) {\n                var record = el.getModel().data;\n                return isInRecords(records, record, xFiled, yField);\n            });\n            _this.setElementsState(effectElements, enable, allElements);\n        });\n    };\n    // 设置兄弟 view 的状态\n    ElementRangeState.prototype.setSiblingsState = function (enable) {\n        var _this = this;\n        var view = this.context.view;\n        var siblings = getSilbings(view);\n        if (isMask(this.context)) {\n            // 受 mask 影响\n            each(siblings, function (sibling) {\n                var allElements = getElements(sibling);\n                var effectElements = getSiblingMaskElements(_this.context, sibling, 10);\n                if (effectElements && effectElements.length) {\n                    _this.setElementsState(effectElements, enable, allElements);\n                }\n                else {\n                    _this.clearViewState(sibling);\n                }\n            });\n        }\n    };\n    ElementRangeState.prototype.setElementsState = function (elements, enable, allElements) {\n        var _this = this;\n        each(allElements, function (el) {\n            if (!elements.includes(el)) {\n                _this.setElementState(el, false);\n            }\n            else {\n                _this.setElementState(el, enable);\n            }\n        });\n    };\n    /**\n     * 结束\n     */\n    ElementRangeState.prototype.end = function () {\n        this.isStarted = false;\n        this.endPoint = this.getCurrentPoint();\n    };\n    // 复写 clear\n    ElementRangeState.prototype.clear = function () {\n        var _this = this;\n        var view = this.context.view;\n        // 判断是否影响 siblings\n        if (this.effectSiblings) {\n            var siblings = getSilbings(view);\n            each(siblings, function (sibling) {\n                _this.clearViewState(sibling);\n            });\n        }\n        else {\n            this.clearViewState(view);\n        }\n    };\n    return ElementRangeState;\n}(StateBase));\nexport default ElementRangeState;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}