{"ast":null,"code":"import _asyncToGenerator from \"/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CurrentConfigurationGQL } from '@ridy/admin-panel/generated/graphql';\nimport { firstValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ridy/admin-panel/generated/graphql\";\nimport * as i2 from \"@angular/router\";\nexport class CurrentConfigService {\n  constructor(currentConfigGql, router, route) {\n    this.currentConfigGql = currentConfigGql;\n    this.router = router;\n    this.route = route;\n  }\n  getConfig() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (_this.currentConfig != null) {\n        return _this.currentConfig;\n      }\n      const queryResult = yield firstValueFrom(_this.currentConfigGql.fetch({}));\n      if (queryResult.error != null) {\n        _this.logout();\n      }\n      _this.currentConfig = queryResult.data;\n      return _this.currentConfig;\n    })();\n  }\n  logout() {\n    localStorage.removeItem('ridy_admin_token');\n    this.router.navigate(['login'], {\n      relativeTo: this.route.root\n    });\n    window.location.reload();\n  }\n  static {\n    this.ɵfac = function CurrentConfigService_Factory(t) {\n      return new (t || CurrentConfigService)(i0.ɵɵinject(i1.CurrentConfigurationGQL), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i2.ActivatedRoute));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: CurrentConfigService,\n      factory: CurrentConfigService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["ActivatedRoute","Router","CurrentConfigurationGQL","firstValueFrom","CurrentConfigService","constructor","currentConfigGql","router","route","getConfig","_this","_asyncToGenerator","currentConfig","queryResult","fetch","error","logout","data","localStorage","removeItem","navigate","relativeTo","root","window","location","reload","i0","ɵɵinject","i1","i2","factory","ɵfac","providedIn"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/apps/admin-panel/src/app/cms/current-config.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport {\n  CurrentConfigurationGQL,\n  CurrentConfigurationQuery,\n} from '@ridy/admin-panel/generated/graphql';\nimport { firstValueFrom } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CurrentConfigService {\n  currentConfig?: CurrentConfigurationQuery;\n\n  constructor(\n    private currentConfigGql: CurrentConfigurationGQL,\n    private router: Router,\n    private route: ActivatedRoute\n  ) {}\n\n  async getConfig(): Promise<CurrentConfigurationQuery> {\n    if (this.currentConfig != null) {\n      return this.currentConfig;\n    }\n    const queryResult = await firstValueFrom(this.currentConfigGql.fetch({}));\n    if (queryResult.error != null) {\n      this.logout();\n    }\n    this.currentConfig = queryResult.data;\n    return this.currentConfig;\n  }\n\n  logout() {\n    localStorage.removeItem('ridy_admin_token');\n    this.router.navigate(['login'], { relativeTo: this.route.root });\n    window.location.reload();\n  }\n}\n"],"mappings":";AACA,SAASA,cAAc,EAAEC,MAAM,QAAQ,iBAAiB;AACxD,SACEC,uBAAuB,QAElB,qCAAqC;AAC5C,SAASC,cAAc,QAAQ,MAAM;;;;AAKrC,OAAM,MAAOC,oBAAoB;EAG/BC,YACUC,gBAAyC,EACzCC,MAAc,EACdC,KAAqB;IAFrB,KAAAF,gBAAgB,GAAhBA,gBAAgB;IAChB,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,KAAK,GAALA,KAAK;EACZ;EAEGC,SAASA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACb,IAAID,KAAI,CAACE,aAAa,IAAI,IAAI,EAAE;QAC9B,OAAOF,KAAI,CAACE,aAAa;;MAE3B,MAAMC,WAAW,SAASV,cAAc,CAACO,KAAI,CAACJ,gBAAgB,CAACQ,KAAK,CAAC,EAAE,CAAC,CAAC;MACzE,IAAID,WAAW,CAACE,KAAK,IAAI,IAAI,EAAE;QAC7BL,KAAI,CAACM,MAAM,EAAE;;MAEfN,KAAI,CAACE,aAAa,GAAGC,WAAW,CAACI,IAAI;MACrC,OAAOP,KAAI,CAACE,aAAa;IAAC;EAC5B;EAEAI,MAAMA,CAAA;IACJE,YAAY,CAACC,UAAU,CAAC,kBAAkB,CAAC;IAC3C,IAAI,CAACZ,MAAM,CAACa,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE;MAAEC,UAAU,EAAE,IAAI,CAACb,KAAK,CAACc;IAAI,CAAE,CAAC;IAChEC,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE;EAC1B;;;uBAzBWrB,oBAAoB,EAAAsB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAA1B,uBAAA,GAAAwB,EAAA,CAAAC,QAAA,CAAAE,EAAA,CAAA5B,MAAA,GAAAyB,EAAA,CAAAC,QAAA,CAAAE,EAAA,CAAA7B,cAAA;IAAA;EAAA;;;aAApBI,oBAAoB;MAAA0B,OAAA,EAApB1B,oBAAoB,CAAA2B,IAAA;MAAAC,UAAA,EAFnB;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}