{"ast":null,"code":"import { each, isNumber } from '@antv/util';\nimport { getMaxLabelWidth } from '../../util/label';\nimport { getMatrixByAngle } from '../../util/matrix';\nimport Theme from '../../util/theme';\n// 统一设置文本的角度\nfunction setLabelsAngle(labels, angle) {\n  each(labels, function (label) {\n    var x = label.attr('x');\n    var y = label.attr('y');\n    var matrix = getMatrixByAngle({\n      x: x,\n      y: y\n    }, angle);\n    label.attr('matrix', matrix);\n  });\n}\n// 旋转文本\nfunction labelRotate(isVertical, labelsGroup, limitLength, getAngle) {\n  var labels = labelsGroup.getChildren();\n  if (!labels.length) {\n    return false;\n  }\n  if (!isVertical && labels.length < 2) {\n    // 水平时至少有两个时才旋转\n    return false;\n  }\n  var maxWidth = getMaxLabelWidth(labels);\n  var isOverlap = false;\n  if (isVertical) {\n    // limitLength 为 0 或者 null 时不生效\n    isOverlap = !!limitLength && maxWidth > limitLength;\n  } else {\n    // 同 limitLength 无关\n    var tickWidth = Math.abs(labels[1].attr('x') - labels[0].attr('x'));\n    isOverlap = maxWidth > tickWidth;\n  }\n  if (isOverlap) {\n    var angle = getAngle(limitLength, maxWidth);\n    setLabelsAngle(labels, angle);\n  }\n  return isOverlap;\n}\nexport function getDefault() {\n  return fixedAngle;\n}\n/**\n * 固定角度旋转文本\n * @param  {boolean} isVertical  是否垂直方向\n * @param  {IGroup}  labelsGroup 文本的 group\n * @param  {number}  limitLength 限定长度\n * @param  {number}  customRotate 自定义旋转角度\n * @return {boolean}             是否发生了旋转\n */\nexport function fixedAngle(isVertical, labelsGroup, limitLength, customRotate) {\n  return labelRotate(isVertical, labelsGroup, limitLength, function () {\n    if (isNumber(customRotate)) {\n      return customRotate;\n    }\n    return isVertical ? Theme.verticalAxisRotate : Theme.horizontalAxisRotate;\n  });\n}\n/**\n * 非固定角度旋转文本\n * @param  {boolean} isVertical  是否垂直方向\n * @param  {IGroup}  labelsGroup 文本的 group\n * @param  {number}  limitLength 限定长度\n * @return {boolean}             是否发生了旋转\n */\nexport function unfixedAngle(isVertical, labelsGroup, limitLength) {\n  return labelRotate(isVertical, labelsGroup, limitLength, function (length, maxWidth) {\n    if (!length) {\n      // 如果没有设置 limitLength，则使用固定的角度旋转\n      return isVertical ? Theme.verticalAxisRotate : Theme.horizontalAxisRotate;\n    }\n    if (isVertical) {\n      // 垂直时不需要判定 limitLength > maxWidth ，因为此时不会 overlap\n      return -Math.acos(length / maxWidth);\n    } else {\n      var angle = 0;\n      if (length > maxWidth) {\n        // 需要判定，asin 的参数 -1， 1\n        angle = Math.PI / 4;\n      } else {\n        angle = Math.asin(length / maxWidth);\n        if (angle > Math.PI / 4) {\n          // 大于 Math.PI / 4 时没意义\n          angle = Math.PI / 4;\n        }\n      }\n      return angle;\n    }\n  });\n}","map":{"version":3,"names":["each","isNumber","getMaxLabelWidth","getMatrixByAngle","Theme","setLabelsAngle","labels","angle","label","x","attr","y","matrix","labelRotate","isVertical","labelsGroup","limitLength","getAngle","getChildren","length","maxWidth","isOverlap","tickWidth","Math","abs","getDefault","fixedAngle","customRotate","verticalAxisRotate","horizontalAxisRotate","unfixedAngle","acos","PI","asin"],"sources":["/Users/obiechina/Documents/ridy-flutter-full-taxi-solution 2/node_modules/@antv/component/esm/axis/overlap/auto-rotate.js"],"sourcesContent":["import { each, isNumber } from '@antv/util';\nimport { getMaxLabelWidth } from '../../util/label';\nimport { getMatrixByAngle } from '../../util/matrix';\nimport Theme from '../../util/theme';\n// 统一设置文本的角度\nfunction setLabelsAngle(labels, angle) {\n    each(labels, function (label) {\n        var x = label.attr('x');\n        var y = label.attr('y');\n        var matrix = getMatrixByAngle({ x: x, y: y }, angle);\n        label.attr('matrix', matrix);\n    });\n}\n// 旋转文本\nfunction labelRotate(isVertical, labelsGroup, limitLength, getAngle) {\n    var labels = labelsGroup.getChildren();\n    if (!labels.length) {\n        return false;\n    }\n    if (!isVertical && labels.length < 2) {\n        // 水平时至少有两个时才旋转\n        return false;\n    }\n    var maxWidth = getMaxLabelWidth(labels);\n    var isOverlap = false;\n    if (isVertical) {\n        // limitLength 为 0 或者 null 时不生效\n        isOverlap = !!limitLength && maxWidth > limitLength;\n    }\n    else {\n        // 同 limitLength 无关\n        var tickWidth = Math.abs(labels[1].attr('x') - labels[0].attr('x'));\n        isOverlap = maxWidth > tickWidth;\n    }\n    if (isOverlap) {\n        var angle = getAngle(limitLength, maxWidth);\n        setLabelsAngle(labels, angle);\n    }\n    return isOverlap;\n}\nexport function getDefault() {\n    return fixedAngle;\n}\n/**\n * 固定角度旋转文本\n * @param  {boolean} isVertical  是否垂直方向\n * @param  {IGroup}  labelsGroup 文本的 group\n * @param  {number}  limitLength 限定长度\n * @param  {number}  customRotate 自定义旋转角度\n * @return {boolean}             是否发生了旋转\n */\nexport function fixedAngle(isVertical, labelsGroup, limitLength, customRotate) {\n    return labelRotate(isVertical, labelsGroup, limitLength, function () {\n        if (isNumber(customRotate)) {\n            return customRotate;\n        }\n        return isVertical ? Theme.verticalAxisRotate : Theme.horizontalAxisRotate;\n    });\n}\n/**\n * 非固定角度旋转文本\n * @param  {boolean} isVertical  是否垂直方向\n * @param  {IGroup}  labelsGroup 文本的 group\n * @param  {number}  limitLength 限定长度\n * @return {boolean}             是否发生了旋转\n */\nexport function unfixedAngle(isVertical, labelsGroup, limitLength) {\n    return labelRotate(isVertical, labelsGroup, limitLength, function (length, maxWidth) {\n        if (!length) {\n            // 如果没有设置 limitLength，则使用固定的角度旋转\n            return isVertical ? Theme.verticalAxisRotate : Theme.horizontalAxisRotate;\n        }\n        if (isVertical) {\n            // 垂直时不需要判定 limitLength > maxWidth ，因为此时不会 overlap\n            return -Math.acos(length / maxWidth);\n        }\n        else {\n            var angle = 0;\n            if (length > maxWidth) {\n                // 需要判定，asin 的参数 -1， 1\n                angle = Math.PI / 4;\n            }\n            else {\n                angle = Math.asin(length / maxWidth);\n                if (angle > Math.PI / 4) {\n                    // 大于 Math.PI / 4 时没意义\n                    angle = Math.PI / 4;\n                }\n            }\n            return angle;\n        }\n    });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}